

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Efficiently Selecting and Processing Raster and Vector Data &#8212; InGARSS Scaling Science Workshop 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/03_raster_and_vector';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Analyzing Agricultural Fields and Temperature Patterns in India using Lonboard" href="02_dynamic_visualization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    InGARSS Scaling Science Workshop 2024
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_setup.html">Setup for InGARSS 2024 workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_stac_and_zarr.html">Exploring Cloud Native Geospatial Data Formats with ERA5 Reanalysis Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_dynamic_visualization.html">Analyzing Agricultural Fields and Temperature Patterns in India using Lonboard</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Efficiently Selecting and Processing Raster and Vector Data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/developmentseed/ingarss-workshop-2024/blob/main/book/docs/03_raster_and_vector.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/developmentseed/ingarss-workshop-2024" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/developmentseed/ingarss-workshop-2024/edit/main/book/docs/03_raster_and_vector.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/developmentseed/ingarss-workshop-2024/issues/new?title=Issue%20on%20page%20%2Fdocs/03_raster_and_vector.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/03_raster_and_vector.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Efficiently Selecting and Processing Raster and Vector Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-objectives">Main Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-raster-data">Accessing raster data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-raster-data">Working with Raster Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-raster-data">Visualizing raster data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deciphering-the-raster-coordinate-reference-system-crs">Deciphering the Raster Coordinate Reference System (CRS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-raster-statistics">Calculate Raster Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-data">Dealing with Missing Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#incorporating-multiple-bands">Incorporating multiple bands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-cloud-covered-and-invalid-pixels">Dealing with cloud-covered and invalid pixels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-a-spectral-index">Calculate a spectral index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zonal-statistics">Zonal statistics</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="efficiently-selecting-and-processing-raster-and-vector-data">
<h1>Efficiently Selecting and Processing Raster and Vector Data<a class="headerlink" href="#efficiently-selecting-and-processing-raster-and-vector-data" title="Permalink to this heading">#</a></h1>
<p>This workflow introduces how to search for, acquire and process raster data efficiently. Specfically, we demonstrate finding <a class="reference external" href="https://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-2">Sentinel-2</a> satellite imagery relevant for an area and time, in this case, a time range of a few months (during the Kharif season) in 2020 over a subdistrict in India.</p>
<p>Note: some portions of this notebook are inspired by the <a class="reference external" href="https://carpentries-incubator.github.io/geospatial-python/index.html">Introduction to Geospatial Raster and Vector Data with Python course</a>.</p>
<section id="main-objectives">
<h2>Main Objectives<a class="headerlink" href="#main-objectives" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Access Sentinel-2 data</strong>: Locate and retrieve relevant Sentinel-2 data for a specific area and timeframe via STAC.</p></li>
<li><p><strong>Inspect and visualize raster data</strong>: Examine metadata, including projections, bands, dimensions, no data pixels. Plot raster data correctly.</p></li>
<li><p><strong>Process multi-spectral raster data</strong>: Work with vector data to establish bounds, manage coordinate systems, and set up the area of interest (AOI).</p></li>
<li><p><strong>Interpret time-series raster data</strong>: Learn to explore the time dimension for raster data and search for temporal patterns.</p></li>
<li><p><strong>Cloud and nodata masking</strong>: Handle clouds and no data pixels.</p></li>
<li><p><strong>Compositing</strong>: Create composites from multiple image scenes.</p></li>
<li><p><strong>Speed up raster processing with Dask</strong>: Learn how to optimize raster processing steps using a parallel processing library.</p></li>
<li><p><strong>Raster band math</strong>: Calculate relevant spectral indices using Sentinel-2 data.</p></li>
<li><p><strong>Scalably visualize vector data with Lonboard</strong>: Load a field boundaries with 10000 polygons and visualize it with Lonboard.</p></li>
<li><p><strong>Calculate zonal statistics with the field boundaries</strong>: Show how to calculate zonal statistics for a spectral index.</p></li>
</ul>
<p>At the end, you’ll be able to efficiently process raster imagery for a region and time of interest!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%time
import os
from pathlib import Path

data_dir = Path(&quot;data&quot;)

try:
    import google.colab
    IN_COLAB = True
except:
    IN_COLAB = False

if IN_COLAB:
    # Mount drive to access data
    from google.colab import drive
    drive.mount(&#39;/content/drive&#39;)

    !pip install uv
    !uv pip install --system \
        &quot;adlfs&gt;=2024.7.0&quot; \
        &quot;dask&gt;=2024.11.2&quot; \
        &quot;fsspec&gt;=2024.10.0&quot; \
        &quot;geocube&gt;=0.7.0&quot; \
        &quot;geopandas&gt;=1.0.1&quot; \
        &quot;lonboard&gt;=0.10.3&quot; \
        &quot;matplotlib&gt;=3.9.2&quot; \
        &quot;planetary-computer&gt;=1.0.0&quot; \
        &quot;pyarrow&gt;=18.0.0&quot; \
        &quot;pystac-client&gt;=0.8.5&quot; \
        &quot;xarray&gt;=2024.11.0&quot; \
        &quot;zarr&gt;=2.18.3&quot; \
        &quot;odc-stac&gt;=0.3.10&quot; \
        &quot;rasterio&gt;=1.4.2&quot; \
        &quot;rioxarray&gt;=0.18.1&quot; \
        &quot;rasterstats&gt;=0.20.0&quot; \
        &quot;numpy&gt;=2.1.3&quot; \
        &quot;scipy==1.14.1&quot;

    data_dir = Path(&quot;/content/drive/MyDrive/ingarss_workshop_2024&quot;)

    print(&quot;✅ Environment activated and data ready!&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 223 µs, sys: 98 µs, total: 321 µs
Wall time: 327 µs
</pre></div>
</div>
</div>
</div>
<p>Let’s begin by importing our necessary packages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">odc.stac</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pystac_client</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">rioxarray</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">geocube.api.core</span> <span class="kn">import</span> <span class="n">make_geocube</span>
<span class="kn">from</span> <span class="nn">geopandas</span> <span class="kn">import</span> <span class="n">GeoSeries</span><span class="p">,</span> <span class="n">GeoDataFrame</span>
<span class="kn">from</span> <span class="nn">lonboard</span> <span class="kn">import</span> <span class="n">Map</span><span class="p">,</span> <span class="n">PolygonLayer</span><span class="p">,</span> <span class="n">viz</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">CRS</span>
<span class="kn">from</span> <span class="nn">rasterstats</span> <span class="kn">import</span> <span class="n">zonal_stats</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">box</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">shape</span>
<span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">dask</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">odc.stac</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">math</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;geopandas&#39;
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Note: In Colab, restart the runtime after installing the packages to ensure all the packages are loaded.</p>
</div></blockquote>
</section>
<section id="accessing-raster-data">
<h2>Accessing raster data<a class="headerlink" href="#accessing-raster-data" title="Permalink to this heading">#</a></h2>
<p>We’ll select an area of interest by randomly sampling a subdistrict within India. This is what we will use to obtain geographic bounds required for selecting and acquiring raster data.</p>
<p>Note that we set the coordinate reference system (CRS) to the projection that is used to load web map tiles and store coordinate metadata in the STAC catalog, <code class="docutils literal notranslate"><span class="pre">EPSG:4326</span> <span class="pre">(WGS</span> <span class="pre">84)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the subdistricts boundaries dataset</span>
<span class="n">subdistricts</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/karnataka_district/KA_subdistrict.shp&quot;</span><span class="p">)</span>
<span class="c1"># Shuffle the dataset items</span>
<span class="n">subdistricts</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Select the first subdistrict</span>
<span class="n">subdistrict</span> <span class="o">=</span> <span class="n">subdistricts</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="n">subdistrict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>district</th>
      <th>subdistric</th>
      <th>UID</th>
      <th>RID</th>
      <th>layer</th>
      <th>path</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KARNATAKA</td>
      <td>Bengaluru (Urban)</td>
      <td>Bangalore-South</td>
      <td>97</td>
      <td>091017002000000</td>
      <td>091017000000000_Subdistricts</td>
      <td>C:/Users/SatSure-Chintan/Documents/Dev_Agri/aw...</td>
      <td>POLYGON ((77.51537 12.74491, 77.51444 12.74557...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Obtain a bounding box for the sampled subdistrict. This is for the image search query we will execute shortly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bbox_coords</span> <span class="o">=</span> <span class="n">subdistrict</span><span class="o">.</span><span class="n">total_bounds</span> 
<span class="n">bounding_box</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_coords</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The area of interest can be seen in the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viz</span><span class="p">(</span><span class="n">subdistrict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7d39d853e6664f9cb8557c37e5f936eb", "version_major": 2, "version_minor": 1}</script></div>
</div>
<p>Let’s dive into how to search for and retrieve raster data.</p>
<p>The <a class="reference external" href="https://stacspec.org/en">SpatioTemporal Asset Catalog (STAC)</a> is an open standard created to standardize the organization and description of geospatial assets. It has come to serve a crucial role in the geospatial industry by providing a consistent framework and terminology for indexing and accessing Earth observation data along with relevant metadata. This specification allows for streamlined searching, browsing, and retrieval of geospatial information.</p>
<p>You can explore geospatial datasets using tools like the <a class="reference external" href="https://radiantearth.github.io/stac-browser/#/?.language=en">STAC browser</a>, which provides an up-to-date interface for navigating STAC catalogs. For instance, the <a class="reference external" href="https://radiantearth.github.io/stac-browser/#/external/earth-search.aws.element84.com/v1/?.language=en">“Earth Search” catalog</a>, which includes Sentinel-2 imagery <a class="reference external" href="https://registry.opendata.aws/sentinel-2-l2a-cogs/">hosted on AWS</a>, is a great starting point.</p>
<p>To retrieve data from a catalog, locate its API URL in the STAC Browser by clicking the “Source” button in the top-right corner. This URL serves as a gateway to access and interact with the catalog’s data. For the Earth Search catalog, the API URL would be displayed in this section, enabling you to programmatically access the archive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access AWS STAC for Sentinel-2 Data</span>
<span class="n">aws_stac_url</span> <span class="o">=</span> <span class="s2">&quot;https://earth-search.aws.element84.com/v1&quot;</span>

<span class="c1"># You can query a STAC API endpoint from Python using the pystac_client library:</span>
<span class="n">stac_client</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">aws_stac_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the upcoming steps, we will retrieve imagery from the Sentinel-2 L2A collection, which consists of data products processed to Level 2A. This processing level provides bottom-of-atmosphere (BOA) reflectance, making the data ready for analysis without additional atmospheric correction.</p>
<p>The data is stored in the <strong>Cloud Optimized GeoTIFF (COG)</strong> format, a type of GeoTIFF specifically designed for efficient access in cloud environments. Unlike traditional GeoTIFFs, COGs are structured with internal data blocks that enable partial retrieval via HTTP requests, eliminating the need to download the entire file. Furthermore, they often include <strong>overviews</strong>, which are lower-resolution versions of the image. These overviews allow users to quickly access less detailed images when high resolution isn’t required, optimizing data transfer and reducing load times for online applications. For more about COGs, visit the <a class="reference external" href="http://cogeo.org/">Cloud Optimized GeoTIFF website</a>.</p>
<p>We parameterize our search for available Sentinel-2 scenes in the <code class="docutils literal notranslate"><span class="pre">sentinel-2-l2a</span></code> collection that meet the following criteria:</p>
<ul class="simple">
<li><p>intersect with a provided bounding box (boundaries of the area of interest);</p></li>
<li><p>were captured between June 1, 2020, and November 30, 2020;</p></li>
<li><p>have less than 25% cloud cover;</p></li>
<li><p>have less than 25% invalid pixels.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_search</span> <span class="o">=</span> <span class="n">stac_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">],</span> <span class="c1"># Sentinel-2, Level 2A, Cloud Optimized GeoTiffs (COGs)</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bbox_coords</span><span class="p">),</span>
    <span class="n">datetime</span><span class="o">=</span><span class="s2">&quot;2020-06-01/2020-11-30&quot;</span><span class="p">,</span> 
    <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lt&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">},</span> <span class="s2">&quot;s2:nodata_pixel_percentage&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lt&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}},</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>At this point, only metadata has been retrieved, meaning the actual image data has not yet been loaded into memory. However, it’s important to note that metadata alone can occupy significant memory, especially when the search criteria match a large number of images. To handle this efficiently, you can limit the number of search results by using the parameter <code class="docutils literal notranslate"><span class="pre">limit=n</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span></code> specifies the maximum number of items to return.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve all items (still just metadata) from search results</span>
<span class="n">s2_items</span> <span class="o">=</span> <span class="n">s2_search</span><span class="o">.</span><span class="n">item_collection</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>After running the query to identify image scenes that match our search criteria, we can check the total number of matches using the <code class="docutils literal notranslate"><span class="pre">.matched()</span></code> method. Keep in mind that this number may change over time as new data continues to be added to the catalog.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s2_search</span><span class="o">.</span><span class="n">matched</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>Which should equate to the number of items collected:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">s2_items</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>Each item corresponds to a single image scene, with metadata that includes details such as the scene’s spatial geometry and the time it was captured. These details are accessible through the item’s properties.</p>
<p>We can see an example for the first item in the search results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="n">s2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020-10-30 05:25:22.755000+00:00
{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[76.9264511632922, 13.561009631756564], [76.84512341593218, 13.195613356232856], [76.84054354907092, 12.569253669512213], [77.85045784138613, 12.560413606130458], [77.86185827663547, 13.552040522490456], [76.9264511632922, 13.561009631756564]]]}
{&#39;created&#39;: &#39;2023-07-14T17:27:10.917Z&#39;, &#39;platform&#39;: &#39;sentinel-2b&#39;, &#39;constellation&#39;: &#39;sentinel-2&#39;, &#39;instruments&#39;: [&#39;msi&#39;], &#39;eo:cloud_cover&#39;: 24.319877, &#39;proj:epsg&#39;: 32643, &#39;mgrs:utm_zone&#39;: 43, &#39;mgrs:latitude_band&#39;: &#39;P&#39;, &#39;mgrs:grid_square&#39;: &#39;GQ&#39;, &#39;grid:code&#39;: &#39;MGRS-43PGQ&#39;, &#39;view:sun_azimuth&#39;: 147.103568735944, &#39;view:sun_elevation&#39;: 58.0694452473349, &#39;s2:degraded_msi_data_percentage&#39;: 0.0108, &#39;s2:nodata_pixel_percentage&#39;: 1.396664, &#39;s2:saturated_defective_pixel_percentage&#39;: 0, &#39;s2:dark_features_percentage&#39;: 0.02103, &#39;s2:cloud_shadow_percentage&#39;: 0.996768, &#39;s2:vegetation_percentage&#39;: 53.468376, &#39;s2:not_vegetated_percentage&#39;: 15.626453, &#39;s2:water_percentage&#39;: 0.83676, &#39;s2:unclassified_percentage&#39;: 4.730735, &#39;s2:medium_proba_clouds_percentage&#39;: 11.588086, &#39;s2:high_proba_clouds_percentage&#39;: 12.680113, &#39;s2:thin_cirrus_percentage&#39;: 0.051677, &#39;s2:snow_ice_percentage&#39;: 0, &#39;s2:product_type&#39;: &#39;S2MSI2A&#39;, &#39;s2:processing_baseline&#39;: &#39;05.00&#39;, &#39;s2:product_uri&#39;: &#39;S2B_MSIL2A_20201030T050939_N0500_R019_T43PGQ_20230315T095508.SAFE&#39;, &#39;s2:generation_time&#39;: &#39;2023-03-15T09:55:08.000000Z&#39;, &#39;s2:datatake_id&#39;: &#39;GS2B_20201030T050939_019064_N05.00&#39;, &#39;s2:datatake_type&#39;: &#39;INS-NOBS&#39;, &#39;s2:datastrip_id&#39;: &#39;S2B_OPER_MSI_L2A_DS_S2RP_20230315T095508_S20201030T052139_N05.00&#39;, &#39;s2:granule_id&#39;: &#39;S2B_OPER_MSI_L2A_TL_S2RP_20230315T095508_A019064_T43PGQ_N05.00&#39;, &#39;s2:reflectance_conversion_factor&#39;: 1.01282262986122, &#39;datetime&#39;: &#39;2020-10-30T05:25:22.755000Z&#39;, &#39;s2:sequence&#39;: &#39;1&#39;, &#39;earthsearch:s3_path&#39;: &#39;s3://sentinel-cogs/sentinel-s2-l2a-cogs/43/P/GQ/2020/10/S2B_43PGQ_20201030_1_L2A&#39;, &#39;earthsearch:payload_id&#39;: &#39;roda-sentinel2/workflow-sentinel2-to-stac/6feb1383623ec2ea4b81ab3672d4f026&#39;, &#39;earthsearch:boa_offset_applied&#39;: True, &#39;processing:software&#39;: {&#39;sentinel2-to-stac&#39;: &#39;0.1.1&#39;}, &#39;updated&#39;: &#39;2023-07-14T17:27:10.917Z&#39;}
</pre></div>
</div>
</div>
</div>
<p>As noted earlier, only the metadata has been retrieved so far. Next, we will access the raster data, which consists of the image pixels for the selected scenes. In STAC terminology, these image files are referred to as “assets,” with each band of an image represented by a separate asset. A straightforward way to load this image data is by using the URLs provided in the assets attribute of the corresponding item.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">assets</span> <span class="o">=</span> <span class="n">s2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">assets</span>  <span class="c1"># first item&#39;s asset dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">assets</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;aot&#39;, &#39;blue&#39;, &#39;coastal&#39;, &#39;granule_metadata&#39;, &#39;green&#39;, &#39;nir&#39;, &#39;nir08&#39;, &#39;nir09&#39;, &#39;red&#39;, &#39;rededge1&#39;, &#39;rededge2&#39;, &#39;rededge3&#39;, &#39;scl&#39;, &#39;swir16&#39;, &#39;swir22&#39;, &#39;thumbnail&#39;, &#39;tileinfo_metadata&#39;, &#39;visual&#39;, &#39;wvp&#39;, &#39;aot-jp2&#39;, &#39;blue-jp2&#39;, &#39;coastal-jp2&#39;, &#39;green-jp2&#39;, &#39;nir-jp2&#39;, &#39;nir08-jp2&#39;, &#39;nir09-jp2&#39;, &#39;red-jp2&#39;, &#39;rededge1-jp2&#39;, &#39;rededge2-jp2&#39;, &#39;rededge3-jp2&#39;, &#39;scl-jp2&#39;, &#39;swir16-jp2&#39;, &#39;swir22-jp2&#39;, &#39;visual-jp2&#39;, &#39;wvp-jp2&#39;])
</pre></div>
</div>
</div>
</div>
<p>We can see a description of the available assets for the respective sensor/instrument like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">asset</span> <span class="ow">in</span> <span class="n">assets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">asset</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aot: Aerosol optical thickness (AOT)
blue: Blue (band 2) - 10m
coastal: Coastal aerosol (band 1) - 60m
granule_metadata: None
green: Green (band 3) - 10m
nir: NIR 1 (band 8) - 10m
nir08: NIR 2 (band 8A) - 20m
nir09: NIR 3 (band 9) - 60m
red: Red (band 4) - 10m
rededge1: Red edge 1 (band 5) - 20m
rededge2: Red edge 2 (band 6) - 20m
rededge3: Red edge 3 (band 7) - 20m
scl: Scene classification map (SCL)
swir16: SWIR 1 (band 11) - 20m
swir22: SWIR 2 (band 12) - 20m
thumbnail: Thumbnail image
tileinfo_metadata: None
visual: True color image
wvp: Water vapour (WVP)
aot-jp2: Aerosol optical thickness (AOT)
blue-jp2: Blue (band 2) - 10m
coastal-jp2: Coastal aerosol (band 1) - 60m
green-jp2: Green (band 3) - 10m
nir-jp2: NIR 1 (band 8) - 10m
nir08-jp2: NIR 2 (band 8A) - 20m
nir09-jp2: NIR 3 (band 9) - 60m
red-jp2: Red (band 4) - 10m
rededge1-jp2: Red edge 1 (band 5) - 20m
rededge2-jp2: Red edge 2 (band 6) - 20m
rededge3-jp2: Red edge 3 (band 7) - 20m
scl-jp2: Scene classification map (SCL)
swir16-jp2: SWIR 1 (band 11) - 20m
swir22-jp2: SWIR 2 (band 12) - 20m
visual-jp2: True color image
wvp-jp2: Water vapour (WVP)
</pre></div>
</div>
</div>
</div>
<p>The Sentinel-2 Level-2A data product offers a variety of assets, including raster files for each optical band captured by the multispectral instrument, a true-color thumbnail image (“visual”), metadata about the instrument, and scene classification layers (“SCL”). Let’s retrieve the URLs associated with these assets to access the respective data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;thumbnail&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/43/P/GQ/2020/10/S2B_43PGQ_20201030_1_L2A/thumbnail.jpg
</pre></div>
</div>
</div>
</div>
<p>The URL points to the image’s location in cloud storage. Since the raster data is stored remotely, we can utilize a library that enables direct access to the image without needing to download it to the local file system beforehand. This library is called <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nir_href</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s2">&quot;nir&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span>
<span class="n">nir</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">nir_href</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (band: 1, y: 10980, x: 10980)&gt; Size: 241MB
[120560400 values with dtype=uint16]
Coordinates:
  * band         (band) int64 8B 1
  * x            (x) float64 88kB 7e+05 7e+05 7e+05 ... 8.097e+05 8.098e+05
  * y            (y) float64 88kB 1.5e+06 1.5e+06 1.5e+06 ... 1.39e+06 1.39e+06
    spatial_ref  int64 8B 0
Attributes:
    OVR_RESAMPLING_ALG:  AVERAGE
    AREA_OR_POINT:       Area
    _FillValue:          0
    scale_factor:        1.0
    add_offset:          0.0
</pre></div>
</div>
</div>
</div>
<p>Optionally, we can then save the raster data to a file on disk if needed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save whole image to disk</span>
<span class="c1">#nir.rio.to_raster(&quot;nir.tif&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>Working with large rasters, such as the 10-meter NIR band containing over 100 million pixels, can be computationally intensive. To optimize processing, it’s often practical to focus on a smaller subset of the data. With the Cloud Optimized GeoTIFF (COG) format, we can efficiently download just the required section instead of the entire file. Before doing so, let’s examine the internal tile size of this band in the COG.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nir</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">tile_size</span> <span class="o">=</span> <span class="n">nir</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span><span class="o">.</span><span class="n">block_shapes</span>
<span class="n">tile_size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 10980, 10980)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1024, 1024)]
</pre></div>
</div>
</div>
</div>
<p>In this case, we specify that we want to download the first band in the TIFF file and extract a subset by slicing the width and height dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save portion of an image to disk</span>
<span class="c1">#nir[0,1024:2048,1024:2048].rio.to_raster(&quot;nir_subset.tif&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>We can read the newly saved image subset and confirm the size is what we expect:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#nir = rioxarray.open_rasterio(&quot;nir_subset.tif&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#nir.shape</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="working-with-raster-data">
<h2>Working with Raster Data<a class="headerlink" href="#working-with-raster-data" title="Permalink to this heading">#</a></h2>
<p>This section introduces key concepts, tools, and attributes related to raster data in Python. It also covers strategies for managing missing or invalid values in raster datasets.</p>
<p>We’ll use the <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code> library as our main tool for raster processing. Built on <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> (a library for working with raster files) and <code class="docutils literal notranslate"><span class="pre">xarray</span></code> (designed for multi-dimensional arrays), <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code> enhances these tools by providing additional geospatial functionality. For example, it includes the <code class="docutils literal notranslate"><span class="pre">open_rasterio</span></code> function for reading raster files and extends <code class="docutils literal notranslate"><span class="pre">xarray</span></code> objects, such as <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>, with geospatial methods via the <code class="docutils literal notranslate"><span class="pre">rio</span></code> accessor. These features become available once you import <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code>.</p>
<p>To demonstrate, we will use the <code class="docutils literal notranslate"><span class="pre">nir09</span></code> band from the first image scene retrieved. This can be loaded with the <code class="docutils literal notranslate"><span class="pre">rioxarray.open_rasterio()</span></code> function, using the URL (Hypertext Reference or <code class="docutils literal notranslate"><span class="pre">href</span></code>) of the band asset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">s2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;nir09&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can quickly inspect the shape and attributes of the newly opened <code class="docutils literal notranslate"><span class="pre">nir09</span></code> dataset we titled <code class="docutils literal notranslate"><span class="pre">raster_b9</span></code> by printing the variable name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (band: 1, y: 1830, x: 1830)&gt; Size: 7MB
[3348900 values with dtype=uint16]
Coordinates:
  * band         (band) int64 8B 1
  * x            (x) float64 15kB 7e+05 7e+05 7.001e+05 ... 8.097e+05 8.097e+05
  * y            (y) float64 15kB 1.5e+06 1.5e+06 1.5e+06 ... 1.39e+06 1.39e+06
    spatial_ref  int64 8B 0
Attributes:
    OVR_RESAMPLING_ALG:  AVERAGE
    AREA_OR_POINT:       Area
    _FillValue:          0
    scale_factor:        1.0
    add_offset:          0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>band</span>: 1</li><li><span class='xr-has-index'>y</span>: 1830</li><li><span class='xr-has-index'>x</span>: 1830</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-160a0b6a-1062-4a0c-96a7-b6f9cb197952' class='xr-array-in' type='checkbox' checked><label for='section-160a0b6a-1062-4a0c-96a7-b6f9cb197952' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[3348900 values with dtype=uint16]</pre></div></div></li><li class='xr-section-item'><input id='section-d0a98752-caea-46a8-b296-350a12a1f420' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d0a98752-caea-46a8-b296-350a12a1f420' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-32ec0637-dfd5-4afb-b49d-b0c3cd7491a3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-32ec0637-dfd5-4afb-b49d-b0c3cd7491a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af2ddab3-5ee8-498a-b622-0221298299be' class='xr-var-data-in' type='checkbox'><label for='data-af2ddab3-5ee8-498a-b622-0221298299be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7e+05 7e+05 ... 8.097e+05 8.097e+05</div><input id='attrs-e89fc7dd-386e-4981-ac88-84b871854879' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e89fc7dd-386e-4981-ac88-84b871854879' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27d27456-fbca-4f24-a910-a26045435a67' class='xr-var-data-in' type='checkbox'><label for='data-27d27456-fbca-4f24-a910-a26045435a67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([699990., 700050., 700110., ..., 809610., 809670., 809730.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.5e+06 1.5e+06 ... 1.39e+06</div><input id='attrs-551a1565-13b4-467d-aac4-132e50edcb5f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-551a1565-13b4-467d-aac4-132e50edcb5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-288e22d2-0672-456b-b52a-a65b03af807b' class='xr-var-data-in' type='checkbox'><label for='data-288e22d2-0672-456b-b52a-a65b03af807b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1499970., 1499910., 1499850., ..., 1390350., 1390290., 1390230.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-bdcc8497-8669-4b7c-bbee-70c1fc388337' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdcc8497-8669-4b7c-bbee-70c1fc388337' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13b566ac-c894-4749-99fb-3671ec8e6e9c' class='xr-var-data-in' type='checkbox'><label for='data-13b566ac-c894-4749-99fb-3671ec8e6e9c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>699960.0 60.0 0.0 1500000.0 0.0 -60.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7b7f49c-2596-45c4-a54b-06950fce24a7' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7b7f49c-2596-45c4-a54b-06950fce24a7' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>band</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-495d2a40-d9a0-4b4c-9fd6-f768eb43ca6a' class='xr-index-data-in' type='checkbox'/><label for='index-495d2a40-d9a0-4b4c-9fd6-f768eb43ca6a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1], dtype=&#x27;int64&#x27;, name=&#x27;band&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8efa9059-8832-44d2-b104-ad0dbc11d418' class='xr-index-data-in' type='checkbox'/><label for='index-8efa9059-8832-44d2-b104-ad0dbc11d418' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([699990.0, 700050.0, 700110.0, 700170.0, 700230.0, 700290.0, 700350.0,
       700410.0, 700470.0, 700530.0,
       ...
       809190.0, 809250.0, 809310.0, 809370.0, 809430.0, 809490.0, 809550.0,
       809610.0, 809670.0, 809730.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1830))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d647d641-3803-432a-8f0c-553b38de4c84' class='xr-index-data-in' type='checkbox'/><label for='index-d647d641-3803-432a-8f0c-553b38de4c84' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1499970.0, 1499910.0, 1499850.0, 1499790.0, 1499730.0, 1499670.0,
       1499610.0, 1499550.0, 1499490.0, 1499430.0,
       ...
       1390770.0, 1390710.0, 1390650.0, 1390590.0, 1390530.0, 1390470.0,
       1390410.0, 1390350.0, 1390290.0, 1390230.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=1830))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-33c83331-05ff-4c18-b493-6e884747a953' class='xr-section-summary-in' type='checkbox'  checked><label for='section-33c83331-05ff-4c18-b493-6e884747a953' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>OVR_RESAMPLING_ALG :</span></dt><dd>AVERAGE</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>_FillValue :</span></dt><dd>0</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">rioxarray.open_rasterio()</span></code> is called, it retrieves the raster data from either local or remote storage and returns an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>. This object is assigned to a variable, such as <code class="docutils literal notranslate"><span class="pre">raster_b9</span></code>. While <code class="docutils literal notranslate"><span class="pre">xarray</span></code> itself also returns a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>, it doesn’t include essential geospatial metadata like scene geometry or projection details. Without <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code>, you can use <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> functions or Python’s math operations on a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> as you would with a <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> array, but you won’t have access to the geospatial information.</p>
<p>The output of the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> includes the variable name, along with details such as the number of bands (1), width in pixels (1830), and height in pixels (1830), as well as the pixel data type (e.g., unsigned integer <code class="docutils literal notranslate"><span class="pre">uint16</span></code>).</p>
<p>Thanks to <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code>, the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> also includes spatial coordinates (x and y) and band information, each with its own data type—<code class="docutils literal notranslate"><span class="pre">float64</span></code> for spatial coordinates and <code class="docutils literal notranslate"><span class="pre">int64</span></code> for bands. Additionally, <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code> allows us to access important geospatial attributes, such as the coordinate reference system (CRS) using <code class="docutils literal notranslate"><span class="pre">.rio.crs</span></code> and the bounding box using <code class="docutils literal notranslate"><span class="pre">.rio.bounds()</span></code>. Note that while most metadata can be accessed directly via attributes like <code class="docutils literal notranslate"><span class="pre">.rio.crs</span></code>, some methods, like <code class="docutils literal notranslate"><span class="pre">.rio.bounds()</span></code>, require parentheses to retrieve the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">nodata</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">bounds</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span><span class="o">.</span><span class="n">block_shapes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EPSG:32643
0
(699960.0, 1390200.0, 809760.0, 1500000.0)
1830
1830
[(256, 256)]
</pre></div>
</div>
</div>
</div>
<p>The Coordinate Reference System for <code class="docutils literal notranslate"><span class="pre">raster_b9.rio.crs</span></code> is returned as <code class="docutils literal notranslate"><span class="pre">EPSG:32643</span></code>. The no-data value is set to <code class="docutils literal notranslate"><span class="pre">0</span></code>, and the bounding box corners of our raster are returned by the output of <code class="docutils literal notranslate"><span class="pre">.bounds()</span></code>. The height and width in number of pixels are returned from <code class="docutils literal notranslate"><span class="pre">.rio.height</span></code> and <code class="docutils literal notranslate"><span class="pre">.rio.width</span></code>, respectively.</p>
</section>
<section id="visualizing-raster-data">
<h2>Visualizing raster data<a class="headerlink" href="#visualizing-raster-data" title="Permalink to this heading">#</a></h2>
<p>We’ve reviewed the attributes of our raster. Now let’s see the raw values of the array with <code class="docutils literal notranslate"><span class="pre">.values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[   0,    0,    0, ..., 2394, 2983, 3095],
        [   0,    0,    0, ..., 2063, 1998, 2116],
        [   0,    0,    0, ..., 2256, 1974, 2850],
        ...,
        [3068, 3056, 2905, ..., 3726, 4071, 4567],
        [3081, 2932, 3007, ..., 2569, 2852, 3336],
        [3065, 3190, 3043, ..., 2229, 2144, 2484]]], dtype=uint16)
</pre></div>
</div>
</div>
</div>
<p>Displaying this allows us to quickly examine the array values, typically by viewing the pixel values at the image’s corners. Since the raster is loaded as a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> in Python, we can easily visualize it using <code class="docutils literal notranslate"><span class="pre">DataArray.plot()</span></code>, much like how we would plot a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, with a single line of code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x1233b5100&gt;
</pre></div>
</div>
<img alt="../_images/ac6ac7f1ce19e26f40b685f3cb1e621fb0ed840b41b5e06cde173f6ed5bf6ef9.png" src="../_images/ac6ac7f1ce19e26f40b685f3cb1e621fb0ed840b41b5e06cde173f6ed5bf6ef9.png" />
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code>, plotting a raster becomes straightforward, with spatial coordinates automatically labeled along the x and y axes for clarity.</p>
<p>The visualization depicts pixel values for the spectral band <code class="docutils literal notranslate"><span class="pre">nir09</span></code> over the selected area of interest. According to Sentinel-2 documentation, this band, with a central wavelength of 945 nm, is particularly sensitive to water vapor. It has a spatial resolution of 60 meters, which, while lower than some other bands, is ideal for quick analyses and demonstrations.</p>
<p>It’s worth noting that the <code class="docutils literal notranslate"><span class="pre">band=1</span></code> label in the image title refers to the order of bands within the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> and not specifically to the Sentinel-2 band asset <code class="docutils literal notranslate"><span class="pre">nir09</span></code>.</p>
<p>The image reveals high reflectance values in cloudy pixels, while other areas show lower contrast, consistent with the band’s sensitivity to water vapor. To enhance color contrast and better interpret the data, you can use the <code class="docutils literal notranslate"><span class="pre">robust=True</span></code> option, which restricts the display range to the 2nd and 98th percentiles of pixel values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x12551e750&gt;
</pre></div>
</div>
<img alt="../_images/cbf402a4ced0dc7f5eb0b92d97fb46debae5001ed98edd3d71bc52d3bf949d88.png" src="../_images/cbf402a4ced0dc7f5eb0b92d97fb46debae5001ed98edd3d71bc52d3bf949d88.png" />
</div>
</div>
<p>This functionality lets you adjust the color limits to better reflect the majority of pixel values in the image.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">robust=True</span></code> option doesn’t provide a satisfactory representation, you can further refine the visualization by manually setting the <code class="docutils literal notranslate"><span class="pre">vmin</span></code> and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> parameters. In some cases, defining a value range may produce a more tailored plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x12563da90&gt;
</pre></div>
</div>
<img alt="../_images/28bdb80831b045fed1ce1b9cc32b73d5d6cc51b5fa2e5051d5f4735e0d30929a.png" src="../_images/28bdb80831b045fed1ce1b9cc32b73d5d6cc51b5fa2e5051d5f4735e0d30929a.png" />
</div>
</div>
<p>Now, if we want to plot a subset of this image to focus more on a specific feature of interest, we can select a region of pixels again. Let’s look at the internal tiling for this band of the COG:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">tile_size</span> <span class="o">=</span> <span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span><span class="o">.</span><span class="n">block_shapes</span>
<span class="n">tile_size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1830, 1830)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(256, 256)]
</pre></div>
</div>
</div>
</div>
<p>Notice that the tile size is smaller because the resolution for this band (<code class="docutils literal notranslate"><span class="pre">nir09</span></code>) is lower (60 meters) than that of the <code class="docutils literal notranslate"><span class="pre">nir</span></code> (10 meters).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the center coordinates of the image</span>
<span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span> <span class="o">=</span> <span class="n">raster_b9</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">raster_b9</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>

<span class="c1"># Select a crop region using .isel()</span>
<span class="n">raster_b9_subset</span> <span class="o">=</span> <span class="n">raster_b9</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">center_x</span> <span class="o">-</span> <span class="n">tile_size</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">center_x</span> <span class="o">+</span> <span class="n">tile_size</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">center_y</span> <span class="o">-</span> <span class="n">tile_size</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">center_y</span> <span class="o">+</span> <span class="n">tile_size</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">raster_b9_subset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Crop of Sentinel-2 COG (NIR)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X Pixel&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y Pixel&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1024, 1024)
</pre></div>
</div>
<img alt="../_images/0438e699d732d2296f1dff9ac48d071386312f39c603d6f8cdf8a24a86a52edd.png" src="../_images/0438e699d732d2296f1dff9ac48d071386312f39c603d6f8cdf8a24a86a52edd.png" />
</div>
</div>
</section>
<section id="deciphering-the-raster-coordinate-reference-system-crs">
<h2>Deciphering the Raster Coordinate Reference System (CRS)<a class="headerlink" href="#deciphering-the-raster-coordinate-reference-system-crs" title="Permalink to this heading">#</a></h2>
<p>An essential detail to examine in geospatial data is the Coordinate Reference System (CRS), which defines how spatial data is mapped to the Earth’s surface. Using the <code class="docutils literal notranslate"><span class="pre">.rio.crs</span></code> method, you can access the CRS information of your dataset. This method retrieves the CRS string associated with your <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EPSG:32643
</pre></div>
</div>
</div>
</div>
<p>EPSG codes are a standardized and concise way to identify specific Coordinate Reference Systems (CRS). To explore detailed information about a CRS, such as its unit of measurement, the <code class="docutils literal notranslate"><span class="pre">pyproj</span></code> library can be used. This library is designed to manage and perform operations related to CRS definitions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epsg</span> <span class="o">=</span> <span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="p">(</span><span class="n">epsg</span><span class="p">)</span>
<span class="n">crs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Projected CRS: EPSG:32643&gt;
Name: WGS 84 / UTM zone 43N
Axis Info [cartesian]:
- E[east]: Easting (metre)
- N[north]: Northing (metre)
Area of Use:
- name: Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.
- bounds: (72.0, 0.0, 78.0, 84.0)
Coordinate Operation:
- name: UTM zone 43N
- method: Transverse Mercator
Datum: World Geodetic System 1984 ensemble
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">CRS</span></code> class from the <code class="docutils literal notranslate"><span class="pre">pyproj</span></code> library enables us to create a CRS object. We can retrieve specific information about a CRS from this, as well as obtain a basic summarization of the associated CRS.</p>
<p>One especially valuable attribute is <code class="docutils literal notranslate"><span class="pre">area_of_use</span></code>, which indicates the geographic boundaries for which the CRS is designed to be applied.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crs</span><span class="o">.</span><span class="n">area_of_use</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AreaOfUse(west=72.0, south=0.0, east=78.0, north=84.0, name=&#39;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># More on the various attributes accessible for the CRS class can be viewed with the following:</span>
<span class="c1"># help(crs)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pyproj</span></code> CRS summary outlines all the details of a Coordinate Reference System (CRS) that Python or GIS software may utilize. For example, it describes the projection as <strong>UTM Zone 43N</strong>, part of the Universal Transverse Mercator (UTM) system, which divides the globe into 60 zones, each covering 6 degrees of longitude.</p>
<p>This specific CRS uses the <strong>WGS84 datum</strong> as its reference point and applies a Cartesian coordinate system with two axes: <code class="docutils literal notranslate"><span class="pre">easting</span></code> and <code class="docutils literal notranslate"><span class="pre">northing</span></code>, measured in meters. Its geographic range spans from <strong>72°E to 78°E</strong> longitude and <strong>0.0°N to 84.0°N</strong> latitude in the northern hemisphere.</p>
<p>The <strong>Transverse Mercator</strong> projection method is employed, optimal for regions with narrow longitudinal widths, such as UTM zones. Additionally, the CRS attributes include the mechanism for projecting coordinates onto a flat (Cartesian) plane. While the UTM system includes zones, not all CRSs are zone-specific, and this detail pertains specifically to UTM-based systems.</p>
</section>
<section id="calculate-raster-statistics">
<h2>Calculate Raster Statistics<a class="headerlink" href="#calculate-raster-statistics" title="Permalink to this heading">#</a></h2>
<p>Knowing basic statistical values of a raster dataset can be valuable. We can obtain some, such as minimum, maximum, mean, and standard deviation quite easily for <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>s like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray ()&gt; Size: 2B
array(0, dtype=uint16)
Coordinates:
    spatial_ref  int64 8B 0
&lt;xarray.DataArray ()&gt; Size: 2B
array(16680, dtype=uint16)
Coordinates:
    spatial_ref  int64 8B 0
&lt;xarray.DataArray ()&gt; Size: 8B
array(4158.79998208)
Coordinates:
    spatial_ref  int64 8B 0
&lt;xarray.DataArray ()&gt; Size: 8B
array(2234.96163071)
Coordinates:
    spatial_ref  int64 8B 0
</pre></div>
</div>
</div>
</div>
<p>So with that, we can get key statistical values such as the minimum, maximum, mean, and standard deviation, along with the data type of the pixels. However, if you’re interested in calculating specific quantiles, <code class="docutils literal notranslate"><span class="pre">xarray</span></code> provides the <code class="docutils literal notranslate"><span class="pre">.quantile()</span></code> method. For example, to determine the 25th and 75th percentiles, you can try the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (quantile: 2)&gt; Size: 16B
array([3054., 4392.])
Coordinates:
  * quantile  (quantile) float64 16B 0.25 0.75
</pre></div>
</div>
</div>
</div>
</section>
<section id="dealing-with-missing-data">
<h2>Dealing with Missing Data<a class="headerlink" href="#dealing-with-missing-data" title="Permalink to this heading">#</a></h2>
<p>So far, we’ve visualized a band from a Sentinel-2 image and calculated its statistics. However, it’s critical to account for missing data, often indicated by a “nodata” value in raster datasets. This special value represents pixels where no valid data is available, typically due to sensor limitations or incomplete coverage. Missing data frequently appears along the raster’s edges when the dataset doesn’t fully cover the analyzed region.</p>
<p>Raster datasets inherently have a rectangular structure, so areas without data—such as boundaries not covered by the sensor—are assigned the nodata value. For example, in this dataset, the nodata value (<code class="docutils literal notranslate"><span class="pre">raster_b9.rio.nodata</span></code>) is <strong>0</strong>. When visualizing the data or calculating statistics, these missing values can be mistakenly treated as valid, leading to skewed results. For instance, including nodata pixels with a value of zero could lower the 25th percentile or other metrics inaccurately.</p>
<p>To handle this, missing data can be represented as <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number), which ensures it is excluded from calculations. This transformation can be achieved by setting the parameter <code class="docutils literal notranslate"><span class="pre">masked=True</span></code> when loading the raster dataset. This approach provides a clearer distinction between valid and missing data, preventing distortion in analyses or visualizations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">s2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;nir09&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can also utilize the <code class="docutils literal notranslate"><span class="pre">where</span></code> function to filter out all the pixels that differ from the raster’s <code class="docutils literal notranslate"><span class="pre">nodata</span></code> value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_b9</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">!=</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">nodata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (band: 1, y: 1830, x: 1830)&gt; Size: 13MB
array([[[  nan,   nan,   nan, ..., 2394., 2983., 3095.],
        [  nan,   nan,   nan, ..., 2063., 1998., 2116.],
        [  nan,   nan,   nan, ..., 2256., 1974., 2850.],
        ...,
        [3068., 3056., 2905., ..., 3726., 4071., 4567.],
        [3081., 2932., 3007., ..., 2569., 2852., 3336.],
        [3065., 3190., 3043., ..., 2229., 2144., 2484.]]], dtype=float32)
Coordinates:
  * band         (band) int64 8B 1
  * x            (x) float64 15kB 7e+05 7e+05 7.001e+05 ... 8.097e+05 8.097e+05
  * y            (y) float64 15kB 1.5e+06 1.5e+06 1.5e+06 ... 1.39e+06 1.39e+06
    spatial_ref  int64 8B 0
Attributes:
    OVR_RESAMPLING_ALG:  AVERAGE
    AREA_OR_POINT:       Area
    scale_factor:        1.0
    add_offset:          0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>band</span>: 1</li><li><span class='xr-has-index'>y</span>: 1830</li><li><span class='xr-has-index'>x</span>: 1830</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d32947bc-8e2e-4195-93a1-71b2d02f5176' class='xr-array-in' type='checkbox' checked><label for='section-d32947bc-8e2e-4195-93a1-71b2d02f5176' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan ... 2.331e+03 2.229e+03 2.144e+03 2.484e+03</span></div><div class='xr-array-data'><pre>array([[[  nan,   nan,   nan, ..., 2394., 2983., 3095.],
        [  nan,   nan,   nan, ..., 2063., 1998., 2116.],
        [  nan,   nan,   nan, ..., 2256., 1974., 2850.],
        ...,
        [3068., 3056., 2905., ..., 3726., 4071., 4567.],
        [3081., 2932., 3007., ..., 2569., 2852., 3336.],
        [3065., 3190., 3043., ..., 2229., 2144., 2484.]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-e821f95c-55e0-44a9-9e41-955a3c4ea088' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e821f95c-55e0-44a9-9e41-955a3c4ea088' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-a46fcf34-f9b8-4fe7-9d4b-df751feac1eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a46fcf34-f9b8-4fe7-9d4b-df751feac1eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef5cc91a-4d89-419b-8ff2-c088fd06b566' class='xr-var-data-in' type='checkbox'><label for='data-ef5cc91a-4d89-419b-8ff2-c088fd06b566' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7e+05 7e+05 ... 8.097e+05 8.097e+05</div><input id='attrs-f3811ed1-0e31-4d78-b5f3-34aadfeab95d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f3811ed1-0e31-4d78-b5f3-34aadfeab95d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96e6f367-d055-49ff-ae0e-e257b3cdf54c' class='xr-var-data-in' type='checkbox'><label for='data-96e6f367-d055-49ff-ae0e-e257b3cdf54c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([699990., 700050., 700110., ..., 809610., 809670., 809730.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.5e+06 1.5e+06 ... 1.39e+06</div><input id='attrs-64e39cea-1b5b-4cb7-b56e-8691df8de5b7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-64e39cea-1b5b-4cb7-b56e-8691df8de5b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c474c836-74a4-44e7-8d64-6f12a195f70b' class='xr-var-data-in' type='checkbox'><label for='data-c474c836-74a4-44e7-8d64-6f12a195f70b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1499970., 1499910., 1499850., ..., 1390350., 1390290., 1390230.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-2238df8e-779c-47a7-a40e-4f61cefaa10f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2238df8e-779c-47a7-a40e-4f61cefaa10f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2b31858-ec02-428b-bffa-97eb52f33d0e' class='xr-var-data-in' type='checkbox'><label for='data-b2b31858-ec02-428b-bffa-97eb52f33d0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>699960.0 60.0 0.0 1500000.0 0.0 -60.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d00f76c0-b5fc-4402-87a3-e33aa82c71d5' class='xr-section-summary-in' type='checkbox'  ><label for='section-d00f76c0-b5fc-4402-87a3-e33aa82c71d5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>band</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4c65a89f-a073-4f0d-93e0-11b468dd48a8' class='xr-index-data-in' type='checkbox'/><label for='index-4c65a89f-a073-4f0d-93e0-11b468dd48a8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1], dtype=&#x27;int64&#x27;, name=&#x27;band&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d610b45f-aab5-48d6-a18b-bfba9fa0d869' class='xr-index-data-in' type='checkbox'/><label for='index-d610b45f-aab5-48d6-a18b-bfba9fa0d869' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([699990.0, 700050.0, 700110.0, 700170.0, 700230.0, 700290.0, 700350.0,
       700410.0, 700470.0, 700530.0,
       ...
       809190.0, 809250.0, 809310.0, 809370.0, 809430.0, 809490.0, 809550.0,
       809610.0, 809670.0, 809730.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1830))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f8fb9bd9-3497-48e4-ba7e-f08b6b3213c6' class='xr-index-data-in' type='checkbox'/><label for='index-f8fb9bd9-3497-48e4-ba7e-f08b6b3213c6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1499970.0, 1499910.0, 1499850.0, 1499790.0, 1499730.0, 1499670.0,
       1499610.0, 1499550.0, 1499490.0, 1499430.0,
       ...
       1390770.0, 1390710.0, 1390650.0, 1390590.0, 1390530.0, 1390470.0,
       1390410.0, 1390350.0, 1390290.0, 1390230.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=1830))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4c9efc3c-e649-4187-9fb8-051064d468f5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4c9efc3c-e649-4187-9fb8-051064d468f5' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>OVR_RESAMPLING_ALG :</span></dt><dd>AVERAGE</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Both approaches will replace the nodata value of <strong>0</strong> with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, allowing missing data to be excluded from calculations. This ensures that recalculated statistics are accurate, as the nodata pixels are no longer treated as valid data points.</p>
<p>By the way, a tip for a cleaner output: you can use the <code class="docutils literal notranslate"><span class="pre">.values</span></code> attribute when applying statistical functions. This returns only the computed values, without including any of the object metadata associated with the raster dataset. This streamlined result is particularly useful for further numerical analysis or visualization, as it provides just the values without the metadata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raster_b9</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
16680.0
4215.6777
2196.2656
</pre></div>
</div>
</div>
</div>
<p>It’s worth mentioning that replacing <code class="docutils literal notranslate"><span class="pre">0</span></code> with <code class="docutils literal notranslate"><span class="pre">nan</span></code> to represent missing data will cause a change in the data type of the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> from integers to floats. This is an important consideration if the data type plays a crucial role in your specific use case or application.</p>
</section>
<section id="incorporating-multiple-bands">
<h2>Incorporating multiple bands<a class="headerlink" href="#incorporating-multiple-bands" title="Permalink to this heading">#</a></h2>
<p>Up to now, we have worked with single-band rasters, focusing on the <code class="docutils literal notranslate"><span class="pre">nir</span></code> and later the <code class="docutils literal notranslate"><span class="pre">nir09</span></code> bands from a Sentinel-2 scene. To obtain a more easy-to-interpret RGB “true-color” depiction of the area, we can utilize the True Color Image (TCI) asset. This asset provides a high-resolution visualization by combining three optical bands—Red, Green, and Blue (RGB)—captured by the Sentinel-2 satellite’s MultiSpectral Instrument (MSI). With a spatial resolution of 10 meters, the TCI functions as a clear and detailed view of the area, making it ideal for quick visual assessments and analysis. Like the <code class="docutils literal notranslate"><span class="pre">nir09</span></code> band, we can load the TCI using:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_overview</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">s2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;visual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">,</span> <span class="n">overview_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">raster_overview</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (band: 3, y: 687, x: 687)&gt; Size: 1MB
[1415907 values with dtype=uint8]
Coordinates:
  * band         (band) int64 24B 1 2 3
  * x            (x) float64 5kB 7e+05 7.002e+05 ... 8.095e+05 8.097e+05
  * y            (y) float64 5kB 1.5e+06 1.5e+06 1.5e+06 ... 1.39e+06 1.39e+06
    spatial_ref  int64 8B 0
Attributes:
    OVR_RESAMPLING_ALG:  AVERAGE
    AREA_OR_POINT:       Area
    _FillValue:          0
    scale_factor:        1.0
    add_offset:          0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>band</span>: 3</li><li><span class='xr-has-index'>y</span>: 687</li><li><span class='xr-has-index'>x</span>: 687</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-15b52ebe-4813-4aa5-b3d2-ac9a7f2c7406' class='xr-array-in' type='checkbox' checked><label for='section-15b52ebe-4813-4aa5-b3d2-ac9a7f2c7406' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[1415907 values with dtype=uint8]</pre></div></div></li><li class='xr-section-item'><input id='section-ab3fd2b4-3e5c-4a37-b5af-77683e81bf8f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ab3fd2b4-3e5c-4a37-b5af-77683e81bf8f' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-b5eab271-7fe2-4fb3-9a6a-04bd2fa8304f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b5eab271-7fe2-4fb3-9a6a-04bd2fa8304f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-acf45e6f-bf3e-49a9-a9be-ac2647424223' class='xr-var-data-in' type='checkbox'><label for='data-acf45e6f-bf3e-49a9-a9be-ac2647424223' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7e+05 7.002e+05 ... 8.097e+05</div><input id='attrs-c1c5bbeb-97e3-403f-a1e5-c0c4808f1846' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1c5bbeb-97e3-403f-a1e5-c0c4808f1846' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-430e9b67-89f5-4233-8b6f-015f7be8a8a1' class='xr-var-data-in' type='checkbox'><label for='data-430e9b67-89f5-4233-8b6f-015f7be8a8a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([700039.912664, 700199.737991, 700359.563319, ..., 809360.436681,
       809520.262009, 809680.087336])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.5e+06 1.5e+06 ... 1.39e+06</div><input id='attrs-b4403cf9-f8a2-44df-964b-4cab718c7b16' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b4403cf9-f8a2-44df-964b-4cab718c7b16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1568ceb4-e89c-4a0e-84f5-ae143672620f' class='xr-var-data-in' type='checkbox'><label for='data-1568ceb4-e89c-4a0e-84f5-ae143672620f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1499920.087336, 1499760.262009, 1499600.436681, ..., 1390599.563319,
       1390439.737991, 1390279.912664])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-0c5c65c6-6ff6-4a82-951e-13488a45e878' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c5c65c6-6ff6-4a82-951e-13488a45e878' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b71dc47f-c4c3-4abc-a80f-8fc1f0549dbc' class='xr-var-data-in' type='checkbox'><label for='data-b71dc47f-c4c3-4abc-a80f-8fc1f0549dbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>699960.0 159.82532751091702 0.0 1500000.0 0.0 -159.82532751091702</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-55c65fb8-b0af-40c7-843e-35f0526e6da9' class='xr-section-summary-in' type='checkbox'  ><label for='section-55c65fb8-b0af-40c7-843e-35f0526e6da9' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>band</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-894b1537-80e8-478c-99c8-1be0113d1a51' class='xr-index-data-in' type='checkbox'/><label for='index-894b1537-80e8-478c-99c8-1be0113d1a51' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3], dtype=&#x27;int64&#x27;, name=&#x27;band&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8bb19219-afc9-4561-bb22-124380947ee7' class='xr-index-data-in' type='checkbox'/><label for='index-8bb19219-afc9-4561-bb22-124380947ee7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([700039.9126637555, 700199.7379912664, 700359.5633187774,
       700519.3886462882, 700679.2139737991, 700839.0393013101,
        700998.864628821, 701158.6899563319, 701318.5152838428,
       701478.3406113537,
       ...
       808241.6593886463, 808401.4847161572, 808561.3100436681,
       808721.1353711791, 808880.9606986899, 809040.7860262009,
       809200.6113537118, 809360.4366812228, 809520.2620087336,
       809680.0873362445],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=687))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a06d15f8-e56b-422e-99e7-586834760d15' class='xr-index-data-in' type='checkbox'/><label for='index-a06d15f8-e56b-422e-99e7-586834760d15' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1499920.0873362445, 1499760.2620087336, 1499600.4366812226,
       1499440.6113537117, 1499280.7860262007,   1499120.96069869,
        1498961.135371179, 1498801.3100436681, 1498641.4847161572,
       1498481.6593886463,
       ...
       1391718.3406113537, 1391558.5152838428, 1391398.6899563319,
        1391238.864628821,   1391079.03930131,  1390919.213973799,
       1390759.3886462883, 1390599.5633187774, 1390439.7379912664,
       1390279.9126637555],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=687))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-859d6022-8e6e-4da1-b85d-950a74320651' class='xr-section-summary-in' type='checkbox'  checked><label for='section-859d6022-8e6e-4da1-b85d-950a74320651' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>OVR_RESAMPLING_ALG :</span></dt><dd>AVERAGE</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>_FillValue :</span></dt><dd>0</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We specified the argument <code class="docutils literal notranslate"><span class="pre">overview_level=3</span></code>, which corresponds to the spatial resolution determined by the level of downsampling in Sentinel-2 COGs. The native spatial resolution for Sentinel-2’s True Color Image (TCI) bands is 10 meters. However, each overview level reduces this resolution by a factor of 2.</p>
<p>The resolution at different overview levels is as follows:</p>
<ul class="simple">
<li><p>Level 0 (native): 10 meters</p></li>
<li><p>Level 1: 20 meters</p></li>
<li><p>Level 2: 40 meters</p></li>
<li><p>Level 3: 80 meters</p></li>
</ul>
<p>When loading GeoTIFFs with the <code class="docutils literal notranslate"><span class="pre">open_rasterio()</span></code> function and checking the shape, the band dimension will appear first. For instance, in the <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> object, the shape would be <code class="docutils literal notranslate"><span class="pre">(band:</span> <span class="pre">3,</span> <span class="pre">y:</span> <span class="pre">687,</span> <span class="pre">x:</span> <span class="pre">687)</span></code>, showing three bands. It’s always a good idea to inspect the shape of the raster array both after loading it and during any data manipulations (such as calculating band ratios or warping). This is especially important since many functions, particularly those for image plotting, expect the raster to have a specific shape (e.g., 1 or 3 channels arranged in a certain order). You can easily verify the shape using the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_overview</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 687, 687)
</pre></div>
</div>
</div>
</div>
<p>You can visualize the multi-band data using the <code class="docutils literal notranslate"><span class="pre">DataArray.plot.imshow()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_overview</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1256f11f0&gt;
</pre></div>
</div>
<img alt="../_images/cab298a150e02225aa2256dd1d9e0b9437939a74bf115aa001e315a2c124d00a.png" src="../_images/cab298a150e02225aa2256dd1d9e0b9437939a74bf115aa001e315a2c124d00a.png" />
</div>
</div>
<p>Keep in mind that the <code class="docutils literal notranslate"><span class="pre">DataArray.plot.imshow()</span></code> function is designed to work with image arrays that have three channels, which corresponds to the RGB color model. It is not suitable for arrays containing more than three channels. However, you can create a false-color image by using different channels in place of the typical RGB.</p>
<p>As shown in the previous figure, the true-color image may appear stretched. To correct the aspect ratio, you can adjust the settings in <code class="docutils literal notranslate"><span class="pre">DataArray.plot.imshow()</span></code>. Since the height-to-width ratio is 1:1 (verified by the <code class="docutils literal notranslate"><span class="pre">rio.height</span></code> and <code class="docutils literal notranslate"><span class="pre">rio.width</span></code> attributes), it’s best to set the aspect ratio to 1. For example, you might choose to set the plot size to 5 inches and specify <code class="docutils literal notranslate"><span class="pre">aspect=1</span></code>. Keep in mind that when using the <code class="docutils literal notranslate"><span class="pre">aspect</span></code> argument, you must also define the plot size, as indicated in the <code class="docutils literal notranslate"><span class="pre">DataArray.plot.imshow()</span></code> documentation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster_overview</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1258394f0&gt;
</pre></div>
</div>
<img alt="../_images/23f0172f5dfc318b1f7d8d710b96464cd7bc6c404a39198b1431c058f5da7bb9.png" src="../_images/23f0172f5dfc318b1f7d8d710b96464cd7bc6c404a39198b1431c058f5da7bb9.png" />
</div>
</div>
<p>Now, let’s consider working not only with visual bands but also with other bands like the <code class="docutils literal notranslate"><span class="pre">nir</span></code> band. We’ll introduce a new tool called <a class="reference external" href="https://www.opendatacube.org/">Open Data Cube (ODC)</a>, which we imported as <code class="docutils literal notranslate"><span class="pre">odc</span></code>, to help load multi-spectral time series raster data from STAC into an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>. The <code class="docutils literal notranslate"><span class="pre">odc</span></code> library provides an extension for handling raster data from STAC-compliant catalogs. We’ll use this to more efficiently manage the Sentinel-2 data we previously queried.</p>
<p>In the following cell, the process is as follows:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">s2_data</span> <span class="pre">=</span> <span class="pre">odc.stac.load(...)</span></code></strong>:</p>
<ul class="simple">
<li><p>This loads the actual raster data from the Sentinel-2 items we retrieved earlier. The <code class="docutils literal notranslate"><span class="pre">load</span></code> function from <code class="docutils literal notranslate"><span class="pre">odc</span></code> fetches the data associated with the metadata.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">items=s2_items</span></code></strong>:</p>
<ul class="simple">
<li><p>Here, <code class="docutils literal notranslate"><span class="pre">s2_items</span></code> represents the Sentinel-2 scenes we collected from the STAC catalog, which contain the metadata and location information.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bands=[&quot;red&quot;,</span> <span class="pre">&quot;green&quot;,</span> <span class="pre">&quot;blue&quot;,</span> <span class="pre">&quot;nir&quot;,</span> <span class="pre">&quot;scl&quot;]</span></code></strong>:</p>
<ul class="simple">
<li><p>This specifies the spectral bands to load, including Red, Green, Blue, Near-Infrared (NIR), and the Scene Classification Layer (SCL), which helps identify cloudy pixels.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bbox=box_coords</span></code></strong>:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">bbox</span></code> argument defines the <strong>Area of Interest (AOI)</strong> by specifying the geographic bounding box using coordinates in the format <code class="docutils literal notranslate"><span class="pre">[min_longitude,</span> <span class="pre">min_latitude,</span> <span class="pre">max_longitude,</span> <span class="pre">max_latitude]</span></code>, which corresponds to the region we are interested in.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">progress=tqdm</span></code></strong>:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">progress</span></code> argument integrates <code class="docutils literal notranslate"><span class="pre">tqdm</span></code>, a library that shows a progress bar, helping track the loading process, especially when dealing with large datasets.</p></li>
</ul>
</li>
</ol>
<p><strong>IMPORTANT:</strong>
When the <code class="docutils literal notranslate"><span class="pre">bbox</span></code> argument is provided, <code class="docutils literal notranslate"><span class="pre">odc</span></code> will automatically clip the raster data to match the bounding box. This ensures that only the relevant data for the specified region is returned.</p>
<p>The resulting <code class="docutils literal notranslate"><span class="pre">s2_data</span></code> is an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> that we can use for further analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">items</span><span class="o">=</span><span class="n">s2_items</span><span class="p">[:</span><span class="mi">12</span><span class="p">],</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;nir&quot;</span><span class="p">,</span> <span class="s2">&quot;scl&quot;</span><span class="p">],</span>
    <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_coords</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="n">tqdm</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">odc.stac.load()</span></code> function returns an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> instead of an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> because we are loading multiple spectral bands (e.g., “red”, “green”, “blue”, “nir”, “scl”). An <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> is used to store multiple variables, or bands, each represented as a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>. A <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> typically holds a single variable (e.g. band) along with its associated dimensions and coordinates. Since we are loading more than one band, the function returns a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, which is essentially a collection of <code class="docutils literal notranslate"><span class="pre">DataArrays</span></code>, each corresponding to one of the requested bands.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> structure allows you to work with related variables (e.g., spectral bands) that share common coordinates, such as latitude, longitude, and time. This structure is particularly useful when performing operations that involve multiple bands, like creating a composite RGB image or conducting multi-band analyses.</p>
<p>If you were only loading a single band, the function would return a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>, which is more suited to handling one variable. However, since multiple bands are requested, a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> is the appropriate return type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 318MB
Dimensions:      (y: 2970, x: 3964, time: 3)
Coordinates:
  * y            (y) float64 24kB 1.438e+06 1.438e+06 ... 1.409e+06 1.409e+06
  * x            (x) float64 32kB 7.523e+05 7.523e+05 ... 7.919e+05 7.919e+05
    spatial_ref  int32 4B 32643
  * time         (time) datetime64[ns] 24B 2020-07-12T05:25:21.422000 ... 202...
Data variables:
    red          (time, y, x) uint16 71MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    green        (time, y, x) uint16 71MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    blue         (time, y, x) uint16 71MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    nir          (time, y, x) uint16 71MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    scl          (time, y, x) uint8 35MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1c55de4b-2692-4a1b-96f3-1ad25938a447' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1c55de4b-2692-4a1b-96f3-1ad25938a447' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 2970</li><li><span class='xr-has-index'>x</span>: 3964</li><li><span class='xr-has-index'>time</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-621e2d84-1bdc-498e-aa2b-e4245ca47f4d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-621e2d84-1bdc-498e-aa2b-e4245ca47f4d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.438e+06 1.438e+06 ... 1.409e+06</div><input id='attrs-94db1aaa-aadc-4fe2-921c-db9343a9f03a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-94db1aaa-aadc-4fe2-921c-db9343a9f03a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3773ad5-3b75-4798-9b36-a7eb15c5982f' class='xr-var-data-in' type='checkbox'><label for='data-f3773ad5-3b75-4798-9b36-a7eb15c5982f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([1438285., 1438275., 1438265., ..., 1408615., 1408605., 1408595.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.523e+05 7.523e+05 ... 7.919e+05</div><input id='attrs-dd638933-3ae4-4388-b7e3-1e9cebc2c1e8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dd638933-3ae4-4388-b7e3-1e9cebc2c1e8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1271540-c10f-4885-a28c-1905ccc9f4a0' class='xr-var-data-in' type='checkbox'><label for='data-b1271540-c10f-4885-a28c-1905ccc9f4a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([752255., 752265., 752275., ..., 791865., 791875., 791885.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>32643</div><input id='attrs-bdfb7aca-5b3b-4272-ab85-7be87d593855' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdfb7aca-5b3b-4272-ab85-7be87d593855' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6b35a25-5620-409c-99ff-87ea2188860e' class='xr-var-data-in' type='checkbox'><label for='data-b6b35a25-5620-409c-99ff-87ea2188860e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>spatial_ref :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984 ensemble</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>GeoTransform :</span></dt><dd>752250 10 0 1438290 0 -10</dd></dl></div><div class='xr-var-data'><pre>array(32643, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-07-12T05:25:21.422000 ... 2...</div><input id='attrs-43a2596c-0b02-4336-bc54-9a33e152f553' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-43a2596c-0b02-4336-bc54-9a33e152f553' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e8406b3-90f4-43f6-9c38-886cb1b75b94' class='xr-var-data-in' type='checkbox'><label for='data-0e8406b3-90f4-43f6-9c38-886cb1b75b94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-07-12T05:25:21.422000000&#x27;, &#x27;2020-10-30T05:25:22.754000000&#x27;,
       &#x27;2020-10-30T05:25:22.755000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c2153b79-4bab-40de-b3c0-c478be4f68cf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c2153b79-4bab-40de-b3c0-c478be4f68cf' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>red</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-5b6446c9-b19b-4957-bb15-4ab1eac8f56d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5b6446c9-b19b-4957-bb15-4ab1eac8f56d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1ba87d7-df0a-4797-9754-5e537521a9b4' class='xr-var-data-in' type='checkbox'><label for='data-f1ba87d7-df0a-4797-9754-5e537521a9b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.37 MiB </td>
                        <td> 6.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint16 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>green</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-198e1153-12af-4283-b6fd-a38dfe9d4035' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-198e1153-12af-4283-b6fd-a38dfe9d4035' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4917b68e-8578-4eb3-88a2-e6c92ee113de' class='xr-var-data-in' type='checkbox'><label for='data-4917b68e-8578-4eb3-88a2-e6c92ee113de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.37 MiB </td>
                        <td> 6.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint16 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>blue</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-d2b0888b-7446-448d-aa4b-eba405d4e7ea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2b0888b-7446-448d-aa4b-eba405d4e7ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-441800ae-edfd-453a-9a24-2717018ff90a' class='xr-var-data-in' type='checkbox'><label for='data-441800ae-edfd-453a-9a24-2717018ff90a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.37 MiB </td>
                        <td> 6.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint16 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nir</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-00d4d230-f5b8-4307-a8e5-7590ab80b234' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-00d4d230-f5b8-4307-a8e5-7590ab80b234' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d906ae9d-029d-4d3e-a098-cec76346821c' class='xr-var-data-in' type='checkbox'><label for='data-d906ae9d-029d-4d3e-a098-cec76346821c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.37 MiB </td>
                        <td> 6.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint16 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>scl</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>uint8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-0817052c-caa1-46bb-b0c0-e38b6c08b395' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0817052c-caa1-46bb-b0c0-e38b6c08b395' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0aa8c9d-f6a9-4e1a-9dc2-c0f9b1b5cc36' class='xr-var-data-in' type='checkbox'><label for='data-c0aa8c9d-f6a9-4e1a-9dc2-c0f9b1b5cc36' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 33.68 MiB </td>
                        <td> 3.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint8 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-d245d939-867e-4a7f-a047-dd148ff60fd2' class='xr-section-summary-in' type='checkbox'  ><label for='section-d245d939-867e-4a7f-a047-dd148ff60fd2' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1d14cbc1-e2ea-41ea-a69b-fd56c8e40b8e' class='xr-index-data-in' type='checkbox'/><label for='index-1d14cbc1-e2ea-41ea-a69b-fd56c8e40b8e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1438285.0, 1438275.0, 1438265.0, 1438255.0, 1438245.0, 1438235.0,
       1438225.0, 1438215.0, 1438205.0, 1438195.0,
       ...
       1408685.0, 1408675.0, 1408665.0, 1408655.0, 1408645.0, 1408635.0,
       1408625.0, 1408615.0, 1408605.0, 1408595.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=2970))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-64b75fe0-a748-4aaf-84b1-935ebd31102f' class='xr-index-data-in' type='checkbox'/><label for='index-64b75fe0-a748-4aaf-84b1-935ebd31102f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([752255.0, 752265.0, 752275.0, 752285.0, 752295.0, 752305.0, 752315.0,
       752325.0, 752335.0, 752345.0,
       ...
       791795.0, 791805.0, 791815.0, 791825.0, 791835.0, 791845.0, 791855.0,
       791865.0, 791875.0, 791885.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=3964))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0f2a0f33-b8f2-4c86-a2f6-703587ad3a45' class='xr-index-data-in' type='checkbox'/><label for='index-0f2a0f33-b8f2-4c86-a2f6-703587ad3a45' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-07-12 05:25:21.422000&#x27;, &#x27;2020-10-30 05:25:22.754000&#x27;,
               &#x27;2020-10-30 05:25:22.755000&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1fff0591-e682-47f7-b615-7344046174d1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1fff0591-e682-47f7-b615-7344046174d1' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Notice that the time dimension is automatically interpreted and aligned with the number of items returned from <code class="docutils literal notranslate"><span class="pre">s2_search.matched()</span></code> and <code class="docutils literal notranslate"><span class="pre">len(s2_items)</span></code> earlier. This means that the dataset now contains multiple Sentinel-2 images, each corresponding to different timestamps and overlapping the area of interest (AOI). By default, <code class="docutils literal notranslate"><span class="pre">odc</span></code> stacks these images in a time series, without assuming any manipulation is required on the time dimension.</p>
<p>To visualize the dataset, we can composite the images over time, reducing the temporal dimension to a single layer where each pixel represents the average of all available timestamps. This approach gives us a temporal depth of 1, providing a composite that reflects changes over time, simplifying the data for easier interpretation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data_composite</span> <span class="o">=</span> <span class="n">s2_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice the new shape of the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data_composite</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 471MB
Dimensions:      (y: 2970, x: 3964)
Coordinates:
  * y            (y) float64 24kB 1.438e+06 1.438e+06 ... 1.409e+06 1.409e+06
  * x            (x) float64 32kB 7.523e+05 7.523e+05 ... 7.919e+05 7.919e+05
    spatial_ref  int32 4B 32643
Data variables:
    red          (y, x) float64 94MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    green        (y, x) float64 94MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    blue         (y, x) float64 94MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    nir          (y, x) float64 94MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    scl          (y, x) float64 94MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8a2aa4b4-5541-4f00-9b42-4b1b89660299' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8a2aa4b4-5541-4f00-9b42-4b1b89660299' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 2970</li><li><span class='xr-has-index'>x</span>: 3964</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4f5a41b6-b3b9-4862-9fa4-5e914690ae66' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4f5a41b6-b3b9-4862-9fa4-5e914690ae66' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.438e+06 1.438e+06 ... 1.409e+06</div><input id='attrs-411cb90d-dad9-4738-9d81-965a1c13327a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-411cb90d-dad9-4738-9d81-965a1c13327a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ad80212-c639-4984-9afb-7c5a948caedd' class='xr-var-data-in' type='checkbox'><label for='data-9ad80212-c639-4984-9afb-7c5a948caedd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([1438285., 1438275., 1438265., ..., 1408615., 1408605., 1408595.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.523e+05 7.523e+05 ... 7.919e+05</div><input id='attrs-95aaf37c-9e93-4024-ad15-51e03f5d246b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-95aaf37c-9e93-4024-ad15-51e03f5d246b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f93f696-b601-45d1-aebf-21a2558aa645' class='xr-var-data-in' type='checkbox'><label for='data-9f93f696-b601-45d1-aebf-21a2558aa645' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([752255., 752265., 752275., ..., 791865., 791875., 791885.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>32643</div><input id='attrs-7a506333-9ae1-4113-82ed-1df3626c7c69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a506333-9ae1-4113-82ed-1df3626c7c69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-356e0aae-8596-462f-a815-074f536b5acb' class='xr-var-data-in' type='checkbox'><label for='data-356e0aae-8596-462f-a815-074f536b5acb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>spatial_ref :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984 ensemble</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>GeoTransform :</span></dt><dd>752250 10 0 1438290 0 -10</dd></dl></div><div class='xr-var-data'><pre>array(32643, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-06a9e724-c12e-4dbd-aca8-136a7210af11' class='xr-section-summary-in' type='checkbox'  checked><label for='section-06a9e724-c12e-4dbd-aca8-136a7210af11' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>red</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-a624b7fd-b191-4beb-bf75-92076ce4c967' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a624b7fd-b191-4beb-bf75-92076ce4c967' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-addcdfcf-7672-4098-87f5-01a59e5452a9' class='xr-var-data-in' type='checkbox'><label for='data-addcdfcf-7672-4098-87f5-01a59e5452a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 89.82 MiB </td>
                        <td> 8.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>green</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-f4def0c3-712a-4eff-affb-cf36ed58a952' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4def0c3-712a-4eff-affb-cf36ed58a952' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b33d0b2-2456-4ecf-9d00-f569b6a605f1' class='xr-var-data-in' type='checkbox'><label for='data-1b33d0b2-2456-4ecf-9d00-f569b6a605f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 89.82 MiB </td>
                        <td> 8.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>blue</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-66694ace-9425-42bd-9eb6-d9c6d7d40ae6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-66694ace-9425-42bd-9eb6-d9c6d7d40ae6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17f7338d-e3b4-47e9-bf7f-71d8460cd54a' class='xr-var-data-in' type='checkbox'><label for='data-17f7338d-e3b4-47e9-bf7f-71d8460cd54a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 89.82 MiB </td>
                        <td> 8.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nir</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-e8a4e50d-02d3-4b93-9daf-6f3d2068da9b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e8a4e50d-02d3-4b93-9daf-6f3d2068da9b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f7a6357-989a-4ccb-84fc-62a824245b00' class='xr-var-data-in' type='checkbox'><label for='data-1f7a6357-989a-4ccb-84fc-62a824245b00' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 89.82 MiB </td>
                        <td> 8.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>scl</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-9f494c9c-621a-4017-9554-f34a3c15c01a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f494c9c-621a-4017-9554-f34a3c15c01a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2c5ac60-c0de-48c7-801d-55c3678482c7' class='xr-var-data-in' type='checkbox'><label for='data-a2c5ac60-c0de-48c7-801d-55c3678482c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 89.82 MiB </td>
                        <td> 8.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-79c74e77-6eaf-4bde-81b1-412e755d95bf' class='xr-section-summary-in' type='checkbox'  ><label for='section-79c74e77-6eaf-4bde-81b1-412e755d95bf' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-68220147-f1ca-4dd9-9353-cbfb2de48e0e' class='xr-index-data-in' type='checkbox'/><label for='index-68220147-f1ca-4dd9-9353-cbfb2de48e0e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1438285.0, 1438275.0, 1438265.0, 1438255.0, 1438245.0, 1438235.0,
       1438225.0, 1438215.0, 1438205.0, 1438195.0,
       ...
       1408685.0, 1408675.0, 1408665.0, 1408655.0, 1408645.0, 1408635.0,
       1408625.0, 1408615.0, 1408605.0, 1408595.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=2970))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4032714a-ca0e-4d4c-ac19-9bd32c250492' class='xr-index-data-in' type='checkbox'/><label for='index-4032714a-ca0e-4d4c-ac19-9bd32c250492' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([752255.0, 752265.0, 752275.0, 752285.0, 752295.0, 752305.0, 752315.0,
       752325.0, 752335.0, 752345.0,
       ...
       791795.0, 791805.0, 791815.0, 791825.0, 791835.0, 791845.0, 791855.0,
       791865.0, 791875.0, 791885.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=3964))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2cd3029b-fa42-480e-99a2-c6af498004a0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2cd3029b-fa42-480e-99a2-c6af498004a0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Also notice here that the aspect ratio is not perfectly 1:1, so let’s compute the correct aspect ratio to use when plotting. We can plot a true color image from the dataset by specifying the necessary bands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspect_ratio_composite</span> <span class="o">=</span> <span class="n">s2_data_composite</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">s2_data_composite</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data_composite</span><span class="p">[[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect_ratio_composite</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1258395b0&gt;
</pre></div>
</div>
<img alt="../_images/5c2f8a1b896d60101c2537c903992e578e1967c338ea66370c0adce63684f7f7.png" src="../_images/5c2f8a1b896d60101c2537c903992e578e1967c338ea66370c0adce63684f7f7.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/lillythomas/Documents/work/clay/lt/servir/model/docs/tutorials/ingarss/lib/python3.12/site-packages/rasterio/warp.py:387: NotGeoreferencedWarning: Dataset has no geotransform, gcps, or rpcs. The identity matrix will be returned.
  dest = _reproject(
</pre></div>
</div>
</div>
</div>
<p>We can also plot any single band from the dataset like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data_composite</span><span class="p">[[</span><span class="s2">&quot;nir&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x125fbe840&gt;
</pre></div>
</div>
<img alt="../_images/c87aca462d7677dbee0c97da266d7d9356e46d1fdbd4ed970c62802c46a3523e.png" src="../_images/c87aca462d7677dbee0c97da266d7d9356e46d1fdbd4ed970c62802c46a3523e.png" />
</div>
</div>
<p>Let’s say we want to take a look at the time series for a single band. We can do this by taking the average in the spatial dimensions (x and y) for each timestamp and plotting the values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data_mean_time_series</span> <span class="o">=</span> <span class="n">s2_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Then we can extract the time series for one of bands. Near infrared is interesting because it is useful in determing seasonal phenology.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nir_time_series</span> <span class="o">=</span> <span class="n">s2_data_mean_time_series</span><span class="p">[</span><span class="s2">&quot;nir&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot a line plot for the near infrared averages for each timestamp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">nir_time_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Near Infrared Band&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Time Series of Mean Near Infrared Band Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/37203a183e14fd8a8204df7982336e2943789717d4d138dbc8d1b799f83dd11d.png" src="../_images/37203a183e14fd8a8204df7982336e2943789717d4d138dbc8d1b799f83dd11d.png" />
</div>
</div>
</section>
<section id="dealing-with-cloud-covered-and-invalid-pixels">
<h2>Dealing with cloud-covered and invalid pixels<a class="headerlink" href="#dealing-with-cloud-covered-and-invalid-pixels" title="Permalink to this heading">#</a></h2>
<p>To mask out clouds and invalid pixels from Sentinel-2 data, we can use the ‘SCL’ (Scene Classification Layer) band, which includes cloud and no data information. The SCL band classifies each pixel in the Sentinel-2 image, including cloud-related classes such as cloud shadows, medium-probability clouds, high-probability clouds, and cirrus clouds. By masking out these classes as well as those with the no data value, we can ignore unwanted pixels in the dataset.</p>
<p>First we need to declare the cloud-related SCL classes. The common classes for clouds are:</p>
<blockquote>
<div><p>Cloud Shadows: 3</p>
<p>Low probability clouds: 7</p>
<p>Medium probability clouds: 8</p>
<p>High probability clouds: 9</p>
<p>Thin cirrus: 10</p>
</div></blockquote>
<p>In order to mask out these cloud classes, we’ll create a boolean mask using <code class="docutils literal notranslate"><span class="pre">xarray</span></code>’s <code class="docutils literal notranslate"><span class="pre">.isin()</span></code> method. We will use these masks to filter out cloud-covered and invalid pixels in the red, green, blue, and NIR bands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cloud_classes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  <span class="c1"># Cloud-related SCL classes</span>
<span class="n">cloud_mask</span> <span class="o">=</span> <span class="n">s2_data</span><span class="p">[</span><span class="s1">&#39;scl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cloud_classes</span><span class="p">)</span>
<span class="n">masked_s2_data</span> <span class="o">=</span> <span class="n">s2_data</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nir&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">cloud_mask</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Keep all pixels</span>
</pre></div>
</div>
</div>
</div>
<p>We will do the same for the no data “class.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodata_value</span> <span class="o">=</span>  <span class="n">s2_data</span><span class="p">[</span><span class="s1">&#39;scl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nodata</span>
<span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">s2_data</span><span class="p">[</span><span class="s1">&#39;scl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">nodata_value</span><span class="p">)</span>
<span class="n">masked_s2_data</span> <span class="o">=</span> <span class="n">masked_s2_data</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nir&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">nodata_value</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 565MB
Dimensions:      (time: 3, y: 2970, x: 3964)
Coordinates:
  * y            (y) float64 24kB 1.438e+06 1.438e+06 ... 1.409e+06 1.409e+06
  * x            (x) float64 32kB 7.523e+05 7.523e+05 ... 7.919e+05 7.919e+05
    spatial_ref  int32 4B 32643
  * time         (time) datetime64[ns] 24B 2020-07-12T05:25:21.422000 ... 202...
Data variables:
    red          (time, y, x) float32 141MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    green        (time, y, x) float32 141MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    blue         (time, y, x) float32 141MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    nir          (time, y, x) float32 141MB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-dc97396b-d90d-4b72-a106-7aeaf9ee72ff' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-dc97396b-d90d-4b72-a106-7aeaf9ee72ff' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 3</li><li><span class='xr-has-index'>y</span>: 2970</li><li><span class='xr-has-index'>x</span>: 3964</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e030e8c0-ba87-404f-a2a7-4779a305e6e6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e030e8c0-ba87-404f-a2a7-4779a305e6e6' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.438e+06 1.438e+06 ... 1.409e+06</div><input id='attrs-372b0342-c842-458e-8653-8fd9b6487f09' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-372b0342-c842-458e-8653-8fd9b6487f09' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f1584d7-26ee-47fc-a825-ead3cfd663b6' class='xr-var-data-in' type='checkbox'><label for='data-3f1584d7-26ee-47fc-a825-ead3cfd663b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([1438285., 1438275., 1438265., ..., 1408615., 1408605., 1408595.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.523e+05 7.523e+05 ... 7.919e+05</div><input id='attrs-4a895872-31fb-4d9c-b2f1-b68c40bbee31' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a895872-31fb-4d9c-b2f1-b68c40bbee31' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-616c67f5-2593-44cd-855c-99da9dd4de43' class='xr-var-data-in' type='checkbox'><label for='data-616c67f5-2593-44cd-855c-99da9dd4de43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([752255., 752265., 752275., ..., 791865., 791875., 791885.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>32643</div><input id='attrs-c6510515-83a6-4bc0-8ddc-890e6c6f0680' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6510515-83a6-4bc0-8ddc-890e6c6f0680' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2c36ebd2-45c9-456d-8b5a-8937f88f37d4' class='xr-var-data-in' type='checkbox'><label for='data-2c36ebd2-45c9-456d-8b5a-8937f88f37d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>spatial_ref :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984 ensemble</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>GeoTransform :</span></dt><dd>752250 10 0 1438290 0 -10</dd></dl></div><div class='xr-var-data'><pre>array(32643, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-07-12T05:25:21.422000 ... 2...</div><input id='attrs-11a0457a-f907-4e66-bfe9-e3e27fe9ae4d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-11a0457a-f907-4e66-bfe9-e3e27fe9ae4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5af058c-59d5-429e-b51a-84b4ed889384' class='xr-var-data-in' type='checkbox'><label for='data-a5af058c-59d5-429e-b51a-84b4ed889384' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-07-12T05:25:21.422000000&#x27;, &#x27;2020-10-30T05:25:22.754000000&#x27;,
       &#x27;2020-10-30T05:25:22.755000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e833d41f-d7af-4f08-8424-7d4d34bc32cb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e833d41f-d7af-4f08-8424-7d4d34bc32cb' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>red</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-7e42cf6a-11c3-4875-9973-0d7cac4238e7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7e42cf6a-11c3-4875-9973-0d7cac4238e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-90e392e9-26b3-4d34-abf9-3c0df80ea219' class='xr-var-data-in' type='checkbox'><label for='data-90e392e9-26b3-4d34-abf9-3c0df80ea219' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 134.73 MiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>green</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-e21b1aae-6caf-4e86-8986-a6e712516677' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e21b1aae-6caf-4e86-8986-a6e712516677' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bfe8334d-d522-4fab-9823-b51adc0d99cc' class='xr-var-data-in' type='checkbox'><label for='data-bfe8334d-d522-4fab-9823-b51adc0d99cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 134.73 MiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>blue</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-075cacb4-041c-43b5-85fa-c7a596e9bc60' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-075cacb4-041c-43b5-85fa-c7a596e9bc60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5295aba4-28d2-4b6f-91da-6e96e20cd3bd' class='xr-var-data-in' type='checkbox'><label for='data-5295aba4-28d2-4b6f-91da-6e96e20cd3bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 134.73 MiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nir</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-c4523a4f-f1f4-4d26-a628-dbf3e6beb34d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c4523a4f-f1f4-4d26-a628-dbf3e6beb34d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5162e387-b88c-41b5-b262-de13e0063f77' class='xr-var-data-in' type='checkbox'><label for='data-5162e387-b88c-41b5-b262-de13e0063f77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 134.73 MiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 2970, 3964) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="154" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="30" x2="24" y2="45" />
  <line x1="10" y1="61" x2="24" y2="76" />
  <line x1="10" y1="89" x2="24" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="89" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,104.85778059354855 10.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="55" y2="14" />
  <line x1="71" y1="0" x2="86" y2="14" />
  <line x1="102" y1="0" x2="117" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="45" x2="144" y2="45" />
  <line x1="24" y1="76" x2="144" y2="76" />
  <line x1="24" y1="104" x2="144" y2="104" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="104" style="stroke-width:2" />
  <line x1="55" y1="14" x2="55" y2="104" />
  <line x1="86" y1="14" x2="86" y2="104" />
  <line x1="117" y1="14" x2="117" y2="104" />
  <line x1="144" y1="14" x2="144" y2="104" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,104.85778059354855 24.9485979497544,104.85778059354855" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="124.857781" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="164.948598" y="59.903189" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,59.903189)">2970</text>
  <text x="7.474299" y="117.383482" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,117.383482)">3</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1a0bde17-cd03-4684-a70b-8039115aa663' class='xr-section-summary-in' type='checkbox'  ><label for='section-1a0bde17-cd03-4684-a70b-8039115aa663' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3b7755af-d232-4cb4-8573-19f8dd16362a' class='xr-index-data-in' type='checkbox'/><label for='index-3b7755af-d232-4cb4-8573-19f8dd16362a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1438285.0, 1438275.0, 1438265.0, 1438255.0, 1438245.0, 1438235.0,
       1438225.0, 1438215.0, 1438205.0, 1438195.0,
       ...
       1408685.0, 1408675.0, 1408665.0, 1408655.0, 1408645.0, 1408635.0,
       1408625.0, 1408615.0, 1408605.0, 1408595.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=2970))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-564f2dc0-813d-4a05-b333-327844b08517' class='xr-index-data-in' type='checkbox'/><label for='index-564f2dc0-813d-4a05-b333-327844b08517' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([752255.0, 752265.0, 752275.0, 752285.0, 752295.0, 752305.0, 752315.0,
       752325.0, 752335.0, 752345.0,
       ...
       791795.0, 791805.0, 791815.0, 791825.0, 791835.0, 791845.0, 791855.0,
       791865.0, 791875.0, 791885.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=3964))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1b0faafd-ed22-4d5c-9858-7cd568bbb56e' class='xr-index-data-in' type='checkbox'/><label for='index-1b0faafd-ed22-4d5c-9858-7cd568bbb56e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-07-12 05:25:21.422000&#x27;, &#x27;2020-10-30 05:25:22.754000&#x27;,
               &#x27;2020-10-30 05:25:22.755000&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eb1a59fd-76b7-4880-a16f-24c41d0e98ef' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eb1a59fd-76b7-4880-a16f-24c41d0e98ef' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Let’s examine the masked data to verify the results. To do this, let’s composite the imagery again to get a temporal average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_data_composite</span> <span class="o">=</span> <span class="n">masked_s2_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_data_composite</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 188MB
Dimensions:      (y: 2970, x: 3964)
Coordinates:
  * y            (y) float64 24kB 1.438e+06 1.438e+06 ... 1.409e+06 1.409e+06
  * x            (x) float64 32kB 7.523e+05 7.523e+05 ... 7.919e+05 7.919e+05
    spatial_ref  int32 4B 32643
Data variables:
    red          (y, x) float32 47MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    green        (y, x) float32 47MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    blue         (y, x) float32 47MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    nir          (y, x) float32 47MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-290dddf8-b9b8-43a4-a13f-de548b4edd40' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-290dddf8-b9b8-43a4-a13f-de548b4edd40' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 2970</li><li><span class='xr-has-index'>x</span>: 3964</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e663effa-9bdb-4416-b20b-bcce31494984' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e663effa-9bdb-4416-b20b-bcce31494984' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.438e+06 1.438e+06 ... 1.409e+06</div><input id='attrs-a4c57408-8914-41e6-a05e-0b4942fabde3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a4c57408-8914-41e6-a05e-0b4942fabde3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a01c52ed-91e4-4757-a66c-bebe65f7b582' class='xr-var-data-in' type='checkbox'><label for='data-a01c52ed-91e4-4757-a66c-bebe65f7b582' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([1438285., 1438275., 1438265., ..., 1408615., 1408605., 1408595.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.523e+05 7.523e+05 ... 7.919e+05</div><input id='attrs-1288ce5f-6d97-4649-86ac-830b88fa8948' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1288ce5f-6d97-4649-86ac-830b88fa8948' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3421cbae-5f01-4f6e-a625-8c84e54be45b' class='xr-var-data-in' type='checkbox'><label for='data-3421cbae-5f01-4f6e-a625-8c84e54be45b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([752255., 752265., 752275., ..., 791865., 791875., 791885.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>32643</div><input id='attrs-37ab6e1a-e1e0-4b03-a96a-fff4159acd5c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-37ab6e1a-e1e0-4b03-a96a-fff4159acd5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b53a7f4-d405-46cf-9220-a82ec9dc5d2f' class='xr-var-data-in' type='checkbox'><label for='data-7b53a7f4-d405-46cf-9220-a82ec9dc5d2f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>spatial_ref :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984 ensemble</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>GeoTransform :</span></dt><dd>752250 10 0 1438290 0 -10</dd></dl></div><div class='xr-var-data'><pre>array(32643, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ddf58764-b173-46fc-baeb-d67851cbf209' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ddf58764-b173-46fc-baeb-d67851cbf209' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>red</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-9dfa86c2-710f-4aa3-9bbb-cd27eba7a4fb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9dfa86c2-710f-4aa3-9bbb-cd27eba7a4fb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-658c3f6b-0cd4-40ae-a17e-3eab2cc68a36' class='xr-var-data-in' type='checkbox'><label for='data-658c3f6b-0cd4-40ae-a17e-3eab2cc68a36' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 44.91 MiB </td>
                        <td> 4.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 15 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>green</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-d59c4ad4-7768-49eb-8762-36d288144b8d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d59c4ad4-7768-49eb-8762-36d288144b8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ad2e084-7dad-4d19-87f5-caab816a64d0' class='xr-var-data-in' type='checkbox'><label for='data-9ad2e084-7dad-4d19-87f5-caab816a64d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 44.91 MiB </td>
                        <td> 4.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 15 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>blue</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-c3692778-02b8-45db-b0c0-7c2796e85dbb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c3692778-02b8-45db-b0c0-7c2796e85dbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7218832-b096-448f-ad61-0237cf3d480f' class='xr-var-data-in' type='checkbox'><label for='data-f7218832-b096-448f-ad61-0237cf3d480f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 44.91 MiB </td>
                        <td> 4.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 15 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nir</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-742fed9c-6200-46fa-8f1e-05a78eb2116c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-742fed9c-6200-46fa-8f1e-05a78eb2116c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a209156f-6a58-49f7-b95c-ab4acdc25a06' class='xr-var-data-in' type='checkbox'><label for='data-a209156f-6a58-49f7-b95c-ab4acdc25a06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 44.91 MiB </td>
                        <td> 4.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2970, 3964) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 15 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="139" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="61" x2="120" y2="61" />
  <line x1="0" y1="89" x2="120" y2="89" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="89" style="stroke-width:2" />
  <line x1="30" y1="0" x2="30" y2="89" />
  <line x1="61" y1="0" x2="61" y2="89" />
  <line x1="92" y1="0" x2="92" y2="89" />
  <line x1="120" y1="0" x2="120" y2="89" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,89.90918264379415 0.0,89.90918264379415" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="109.909183" font-size="1.0rem" font-weight="100" text-anchor="middle" >3964</text>
  <text x="140.000000" y="44.954591" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,44.954591)">2970</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-dbd5b62b-3a87-4a3c-aaa1-5ea7638fae26' class='xr-section-summary-in' type='checkbox'  ><label for='section-dbd5b62b-3a87-4a3c-aaa1-5ea7638fae26' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2e272741-7c29-4a5f-bb61-4cef467ef1be' class='xr-index-data-in' type='checkbox'/><label for='index-2e272741-7c29-4a5f-bb61-4cef467ef1be' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1438285.0, 1438275.0, 1438265.0, 1438255.0, 1438245.0, 1438235.0,
       1438225.0, 1438215.0, 1438205.0, 1438195.0,
       ...
       1408685.0, 1408675.0, 1408665.0, 1408655.0, 1408645.0, 1408635.0,
       1408625.0, 1408615.0, 1408605.0, 1408595.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=2970))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-dc1c8843-e392-4ff5-b924-c6e72d3797f6' class='xr-index-data-in' type='checkbox'/><label for='index-dc1c8843-e392-4ff5-b924-c6e72d3797f6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([752255.0, 752265.0, 752275.0, 752285.0, 752295.0, 752305.0, 752315.0,
       752325.0, 752335.0, 752345.0,
       ...
       791795.0, 791805.0, 791815.0, 791825.0, 791835.0, 791845.0, 791855.0,
       791865.0, 791875.0, 791885.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=3964))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8173f58e-1e40-4db3-a25f-34f4cef1786d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8173f58e-1e40-4db3-a25f-34f4cef1786d' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Now we can plot an image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_data_composite</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect_ratio_composite</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x125f0b470&gt;
</pre></div>
</div>
<img alt="../_images/a283366dd3dbc842e234a594050fbb89743ba78bb5b8d7d666631cd14afa4e2b.png" src="../_images/a283366dd3dbc842e234a594050fbb89743ba78bb5b8d7d666631cd14afa4e2b.png" />
</div>
</div>
<p>The image plot is looking a bit over-exposed. Let’s adjust the value ranges to better fit the raster data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_data_composite</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect_ratio_composite</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x125853590&gt;
</pre></div>
</div>
<img alt="../_images/add17d0e856b299365bc9d721daf8168338e2440dde9c00c6278917e22de7162.png" src="../_images/add17d0e856b299365bc9d721daf8168338e2440dde9c00c6278917e22de7162.png" />
</div>
</div>
<p>That looks pretty good! Now we have a cloud-masked composite. We can use this to get a clearer signal of near infrared over time.</p>
</section>
<section id="calculate-a-spectral-index">
<h2>Calculate a spectral index<a class="headerlink" href="#calculate-a-spectral-index" title="Permalink to this heading">#</a></h2>
<p>In this next section, we will use our masked multi-spectral data to calculate a relevant spectral index for tasks such as crop type classification.</p>
<p><strong>NDVI (Normalized Difference Vegetation Index)</strong> is a widely used index to assess vegetation health and density. It quantifies the difference between near-infrared (NIR) light, which vegetation strongly reflects, and red light, which vegetation absorbs. Higher NDVI values typically indicate healthier or denser vegetation, while lower or negative values suggest sparse or no vegetation (e.g., bare soil, urban areas, or water).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_ndvi</span> <span class="o">=</span> <span class="p">(</span><span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;nir&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;nir&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s make a time series again and plot it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_ndvi_mean_time_series</span> <span class="o">=</span> <span class="n">masked_s2_ndvi</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">masked_s2_ndvi_mean_time_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Time Series of Mean NDVI Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/016605dd40e0872e835edb6fcc52632f82a18c62969182687edee1d3ed397a75.png" src="../_images/016605dd40e0872e835edb6fcc52632f82a18c62969182687edee1d3ed397a75.png" />
</div>
</div>
<p>The dataset titled <strong>“10,000 Crop Field Boundaries across India”</strong> (by Wang et al., 2022) contains manually delineated boundaries of 10,000 crop fields across India, created through the analysis of high-resolution satellite imagery from Airbus SPOT. The dataset is specifically designed to support research and applications in crop field mapping and agricultural monitoring, particularly in smallholder farming systems.</p>
<p>This dataset aims to advance methods for identifying and analyzing crop fields at scale, enabling better understanding and management of smallholder farming landscapes. For further details and access to the dataset and model weights, visit the <a class="reference external" href="https://zenodo.org/record/7315090">Zenodo record</a>.</p>
<p>We will use this dataset to demonstrate scalably vector dataset visualization with Lonboard and then subsquently compute zonal statistics using the polygons, our subdistrict and a NDVI raster.</p>
<p>Let’s start by reading in the shapefile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_boundaries_india</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/india_crop_boundary/india_10k_fields.shp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_boundaries_india</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>sample</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9620.550048</td>
      <td>0</td>
      <td>POLYGON ((73.10624 26.30254, 73.10624 26.30257...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5244.485268</td>
      <td>0</td>
      <td>POLYGON ((73.10746 26.3016, 73.10746 26.30162,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1983.845942</td>
      <td>0</td>
      <td>POLYGON ((73.10792 26.3012, 73.10792 26.30122,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5191.243054</td>
      <td>0</td>
      <td>POLYGON ((73.10543 26.29889, 73.10543 26.29893...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5728.435942</td>
      <td>0</td>
      <td>POLYGON ((73.10319 26.29923, 73.10325 26.29923...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10008</th>
      <td>753.823903</td>
      <td>2002</td>
      <td>POLYGON ((91.4845 26.62626, 91.4845 26.62631, ...</td>
    </tr>
    <tr>
      <th>10009</th>
      <td>2500.742071</td>
      <td>2002</td>
      <td>POLYGON ((91.48521 26.62618, 91.48523 26.62618...</td>
    </tr>
    <tr>
      <th>10010</th>
      <td>2002.759594</td>
      <td>2002</td>
      <td>POLYGON ((91.48453 26.62572, 91.48453 26.62577...</td>
    </tr>
    <tr>
      <th>10011</th>
      <td>4013.147174</td>
      <td>2002</td>
      <td>POLYGON ((91.48544 26.625, 91.48544 26.62508, ...</td>
    </tr>
    <tr>
      <th>10012</th>
      <td>456.357790</td>
      <td>2002</td>
      <td>POLYGON ((91.48611 26.62491, 91.48611 26.62495...</td>
    </tr>
  </tbody>
</table>
<p>10013 rows × 3 columns</p>
</div></div></div>
</div>
<p>And then visualize it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span> <span class="o">=</span> <span class="n">PolygonLayer</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span>
    <span class="n">field_boundaries_india</span><span class="p">,</span>
    <span class="n">get_line_width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># width in default units (meters)</span>
    <span class="n">line_width_min_pixels</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>  <span class="c1"># minimum width when zoomed out</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># red</span>
    <span class="n">get_line_color</span><span class="o">=</span><span class="p">[</span><span class="mi">37</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>  <span class="c1"># dark border color</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2fe53c0275a948998d917bf683349d13", "version_major": 2, "version_minor": 1}</script></div>
</div>
<p>Now let’s get all of the field boundaries within the AOI we’ve been focusing on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scene_geom</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">({</span><span class="s1">&#39;geometry&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">shape</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">geometry</span><span class="p">)]},</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped_field_boundaries_india</span> <span class="o">=</span> <span class="n">field_boundaries_india</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">scene_geom</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">clipped_field_boundaries_india</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<p>Let’s visualize the clipped results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span> <span class="o">=</span> <span class="n">PolygonLayer</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span>
    <span class="n">clipped_field_boundaries_india</span><span class="p">,</span>
    <span class="n">get_line_width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># width in default units (meters)</span>
    <span class="n">line_width_min_pixels</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>  <span class="c1"># minimum width when zoomed out</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># red</span>
    <span class="n">get_line_color</span><span class="o">=</span><span class="p">[</span><span class="mi">37</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>  <span class="c1"># dark border color</span>
<span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b21632190ce74a57a63ea3ac8faa7846", "version_major": 2, "version_minor": 1}</script></div>
</div>
</section>
<section id="zonal-statistics">
<h2>Zonal statistics<a class="headerlink" href="#zonal-statistics" title="Permalink to this heading">#</a></h2>
<p>We will calculate <strong>zonal statistics</strong> now for an NDVI composite. Zonal statistics refers to the computation of summary statistics (e.g., mean, sum, min, max) for raster data within the zones defined by vector geometries. This is a common task in spatial analysis for aggregating raster values over regions. We will use a Python library called <code class="docutils literal notranslate"><span class="pre">GeoCube</span></code> to convert vector data (e.g., GeoDataFrames) into rasterized datasets. It allows rasterization while aligning with a reference grid (such as Sentinel-2 data). Its common use case is generating gridded representations of vector data to perform spatial analyses like zonal statistics.</p>
<p>We will use GeoCube to generate summary level zonal statistics and the older library, <code class="docutils literal notranslate"><span class="pre">rasterstats</span></code> to compute polygon level zonal statistics.</p>
<p>Let’s start by creating a numerical class for the polygons. For this, all polygons are simply foreground, so wet set the class for all to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped_field_boundaries_india</span><span class="p">[</span><span class="s2">&quot;numerical_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped_field_boundaries_india</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>sample</th>
      <th>geometry</th>
      <th>numerical_class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>139</th>
      <td>452.008538</td>
      <td>27</td>
      <td>POLYGON ((77.19555 13.00995, 77.19557 13.00995...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>138</th>
      <td>468.519884</td>
      <td>27</td>
      <td>POLYGON ((77.19539 13.01004, 77.1954 13.01004,...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>136</th>
      <td>381.477574</td>
      <td>27</td>
      <td>POLYGON ((77.1955 13.01044, 77.19556 13.01044,...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>137</th>
      <td>449.036190</td>
      <td>27</td>
      <td>POLYGON ((77.19532 13.01038, 77.19533 13.01038...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>135</th>
      <td>559.956668</td>
      <td>27</td>
      <td>POLYGON ((77.19529 13.01065, 77.19531 13.01065...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>524</th>
      <td>3220.019947</td>
      <td>104</td>
      <td>POLYGON ((77.77795 12.67281, 77.77797 12.67281...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>523</th>
      <td>2333.354229</td>
      <td>104</td>
      <td>POLYGON ((77.77656 12.67305, 77.77658 12.67305...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>522</th>
      <td>2175.137974</td>
      <td>104</td>
      <td>POLYGON ((77.77683 12.67553, 77.77684 12.67553...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>521</th>
      <td>6876.249467</td>
      <td>104</td>
      <td>POLYGON ((77.7783 12.67625, 77.77841 12.67625,...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>520</th>
      <td>1781.159808</td>
      <td>104</td>
      <td>POLYGON ((77.78231 12.67702, 77.78232 12.67702...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s get the correct data for this extent, again chunking the data with dask for faster computation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_data</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">items</span><span class="o">=</span><span class="n">s2_items</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;nir&quot;</span><span class="p">,</span> <span class="s2">&quot;scl&quot;</span><span class="p">],</span>
    <span class="n">bbox</span><span class="o">=</span><span class="n">clipped_field_boundaries_india</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span>
    <span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="n">tqdm</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s create a rasterized version of the field boundaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the resolution and bounds based on Sentinel-2 data</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="n">s2_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">s2_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>

<span class="c1"># Rasterize the vector dataset to match Sentinel-2</span>
<span class="n">rasterized_field_boundaries</span> <span class="o">=</span> <span class="n">make_geocube</span><span class="p">(</span>
    <span class="n">vector_data</span><span class="o">=</span><span class="n">clipped_field_boundaries_india</span><span class="p">,</span>
    <span class="n">measurements</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;numerical_class&quot;</span><span class="p">],</span> 
    <span class="n">like</span><span class="o">=</span><span class="n">s2_data</span><span class="p">,</span>  <span class="c1"># Align with the features dataset</span>
<span class="p">)</span>

<span class="c1"># The rasterized output is an xarray.Dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rasterized_field_boundaries</span><span class="p">[</span><span class="s2">&quot;numerical_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1. nan]
</pre></div>
</div>
</div>
</div>
<p>We can see there are <code class="docutils literal notranslate"><span class="pre">nan</span></code> values that we need to remove. Let’s replace those with zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rasterized_field_boundaries</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rasterized_field_boundaries</span><span class="p">),</span> <span class="n">other</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Replace NaNs with 0 (or another value of your choice)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rasterized_field_boundaries</span><span class="p">[</span><span class="s2">&quot;numerical_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 1.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rasterized_field_boundaries</span><span class="p">[</span><span class="s2">&quot;numerical_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x125327200&gt;
</pre></div>
</div>
<img alt="../_images/2aec5de7a1200d25dff674f25072602f4e8f7db7fc777475c06cfe4812b13a13.png" src="../_images/2aec5de7a1200d25dff674f25072602f4e8f7db7fc777475c06cfe4812b13a13.png" />
</div>
</div>
<p>Get the cloud and no data masks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cloud_mask</span> <span class="o">=</span> <span class="n">s2_data</span><span class="p">[</span><span class="s1">&#39;scl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cloud_classes</span><span class="p">)</span>
<span class="n">nodata_value</span> <span class="o">=</span>  <span class="n">s2_data</span><span class="p">[</span><span class="s1">&#39;scl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nodata</span>
<span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">s2_data</span><span class="p">[</span><span class="s1">&#39;scl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">nodata_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Mask the non-SCL bands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodata_masked_s2_data</span> <span class="o">=</span> <span class="n">s2_data</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nir&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">nodata_value</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Keep all pixels</span>
<span class="n">cloud_masked_s2_data</span> <span class="o">=</span> <span class="n">nodata_masked_s2_data</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nir&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">cloud_mask</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Keep all pixels</span>
<span class="n">masked_s2_data</span> <span class="o">=</span> <span class="n">cloud_masked_s2_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Calculate NDVI for this new Sentinel-2 raster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_ndvi</span> <span class="o">=</span> <span class="p">(</span><span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;nir&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;nir&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">masked_s2_data</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">])</span>

<span class="n">masked_s2_ndvi_composite</span> <span class="o">=</span> <span class="n">masked_s2_ndvi</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 4GB
Dimensions:      (time: 3, y: 10111, x: 8699)
Coordinates:
  * y            (y) float64 81kB 1.498e+06 1.498e+06 ... 1.397e+06 1.397e+06
  * x            (x) float64 70kB 7.194e+05 7.194e+05 ... 8.064e+05 8.064e+05
    spatial_ref  int32 4B 32643
  * time         (time) datetime64[ns] 24B 2020-07-12T05:25:21.422000 ... 202...
Data variables:
    red          (time, y, x) float32 1GB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    green        (time, y, x) float32 1GB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    blue         (time, y, x) float32 1GB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;
    nir          (time, y, x) float32 1GB dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a516574b-c60c-4f5b-9ea8-218a52fd1d2a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a516574b-c60c-4f5b-9ea8-218a52fd1d2a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 3</li><li><span class='xr-has-index'>y</span>: 10111</li><li><span class='xr-has-index'>x</span>: 8699</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d12f2b07-fafa-4d32-8fb2-77fc38266b4a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d12f2b07-fafa-4d32-8fb2-77fc38266b4a' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.498e+06 1.498e+06 ... 1.397e+06</div><input id='attrs-5d2bd237-7878-496b-a461-dd543089e57d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d2bd237-7878-496b-a461-dd543089e57d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe9e7338-2cb7-441e-a526-c6c81fffa844' class='xr-var-data-in' type='checkbox'><label for='data-fe9e7338-2cb7-441e-a526-c6c81fffa844' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([1498005., 1497995., 1497985., ..., 1396925., 1396915., 1396905.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.194e+05 7.194e+05 ... 8.064e+05</div><input id='attrs-4ca1fa23-96b5-4791-a338-8808ac517756' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ca1fa23-96b5-4791-a338-8808ac517756' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf1d0e08-7e03-41df-9def-676afe60f684' class='xr-var-data-in' type='checkbox'><label for='data-bf1d0e08-7e03-41df-9def-676afe60f684' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>10.0</dd><dt><span>crs :</span></dt><dd>EPSG:32643</dd></dl></div><div class='xr-var-data'><pre>array([719415., 719425., 719435., ..., 806375., 806385., 806395.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>32643</div><input id='attrs-08641c99-971f-4823-a920-15040306893c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-08641c99-971f-4823-a920-15040306893c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-917f73b6-a311-4c8b-9814-53625f476a56' class='xr-var-data-in' type='checkbox'><label for='data-917f73b6-a311-4c8b-9814-53625f476a56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>spatial_ref :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS[&quot;WGS 84 / UTM zone 43N&quot;,BASEGEOGCRS[&quot;WGS 84&quot;,ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],ID[&quot;EPSG&quot;,4326]],CONVERSION[&quot;UTM zone 43N&quot;,METHOD[&quot;Transverse Mercator&quot;,ID[&quot;EPSG&quot;,9807]],PARAMETER[&quot;Latitude of natural origin&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,75,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,SCALEUNIT[&quot;unity&quot;,1],ID[&quot;EPSG&quot;,8805]],PARAMETER[&quot;False easting&quot;,500000,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1]],USAGE[SCOPE[&quot;Navigation and medium accuracy spatial referencing.&quot;],AREA[&quot;Between 72°E and 78°E, northern hemisphere between equator and 84°N, onshore and offshore. China. India. Kazakhstan. Kyrgyzstan. Maldives. Pakistan. Russian Federation. Tajikistan.&quot;],BBOX[0,72,84,78]],ID[&quot;EPSG&quot;,32643]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984 ensemble</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>GeoTransform :</span></dt><dd>719410 10 0 1498010 0 -10</dd></dl></div><div class='xr-var-data'><pre>array(32643, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-07-12T05:25:21.422000 ... 2...</div><input id='attrs-f3ed4875-69aa-45a7-82ae-6dad5ff56ef5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f3ed4875-69aa-45a7-82ae-6dad5ff56ef5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a76154b-1325-4c59-beb4-47b3ae7716b5' class='xr-var-data-in' type='checkbox'><label for='data-2a76154b-1325-4c59-beb4-47b3ae7716b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-07-12T05:25:21.422000000&#x27;, &#x27;2020-10-30T05:25:22.754000000&#x27;,
       &#x27;2020-10-30T05:25:22.755000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7b72937a-6b3b-4ae9-b437-d23e32746dde' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7b72937a-6b3b-4ae9-b437-d23e32746dde' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>red</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-3105f10b-8c2f-4722-b1b9-6a06c73a9e9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3105f10b-8c2f-4722-b1b9-6a06c73a9e9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6778d11b-60b1-4494-8099-8919a0ac22ea' class='xr-var-data-in' type='checkbox'><label for='data-6778d11b-60b1-4494-8099-8919a0ac22ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 10111, 8699) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 90 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="178" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="12" x2="24" y2="27" />
  <line x1="10" y1="24" x2="24" y2="39" />
  <line x1="10" y1="36" x2="24" y2="51" />
  <line x1="10" y1="48" x2="24" y2="63" />
  <line x1="10" y1="60" x2="24" y2="75" />
  <line x1="10" y1="72" x2="24" y2="87" />
  <line x1="10" y1="85" x2="24" y2="100" />
  <line x1="10" y1="97" x2="24" y2="112" />
  <line x1="10" y1="109" x2="24" y2="124" />
  <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="113" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="22" y1="0" x2="37" y2="14" />
  <line x1="34" y1="0" x2="49" y2="14" />
  <line x1="46" y1="0" x2="61" y2="14" />
  <line x1="58" y1="0" x2="73" y2="14" />
  <line x1="70" y1="0" x2="85" y2="14" />
  <line x1="82" y1="0" x2="97" y2="14" />
  <line x1="95" y1="0" x2="110" y2="14" />
  <line x1="107" y1="0" x2="122" y2="14" />
  <line x1="113" y1="0" x2="128" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 113.24201364850164,0.0 128.19061159825606,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />
  <line x1="24" y1="27" x2="128" y2="27" />
  <line x1="24" y1="39" x2="128" y2="39" />
  <line x1="24" y1="51" x2="128" y2="51" />
  <line x1="24" y1="63" x2="128" y2="63" />
  <line x1="24" y1="75" x2="128" y2="75" />
  <line x1="24" y1="87" x2="128" y2="87" />
  <line x1="24" y1="100" x2="128" y2="100" />
  <line x1="24" y1="112" x2="128" y2="112" />
  <line x1="24" y1="124" x2="128" y2="124" />
  <line x1="24" y1="134" x2="128" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />
  <line x1="37" y1="14" x2="37" y2="134" />
  <line x1="49" y1="14" x2="49" y2="134" />
  <line x1="61" y1="14" x2="61" y2="134" />
  <line x1="73" y1="14" x2="73" y2="134" />
  <line x1="85" y1="14" x2="85" y2="134" />
  <line x1="97" y1="14" x2="97" y2="134" />
  <line x1="110" y1="14" x2="110" y2="134" />
  <line x1="122" y1="14" x2="122" y2="134" />
  <line x1="128" y1="14" x2="128" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 128.19061159825606,14.948597949754403 128.19061159825606,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="76.569605" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" >8699</text>
  <text x="148.190612" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,148.190612,74.948598)">10111</text>
  <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>green</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-ec31ee54-63a5-4de3-b227-d795bf037825' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec31ee54-63a5-4de3-b227-d795bf037825' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab00bf58-4100-4d23-adc2-cea246af7342' class='xr-var-data-in' type='checkbox'><label for='data-ab00bf58-4100-4d23-adc2-cea246af7342' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 10111, 8699) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 90 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="178" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="12" x2="24" y2="27" />
  <line x1="10" y1="24" x2="24" y2="39" />
  <line x1="10" y1="36" x2="24" y2="51" />
  <line x1="10" y1="48" x2="24" y2="63" />
  <line x1="10" y1="60" x2="24" y2="75" />
  <line x1="10" y1="72" x2="24" y2="87" />
  <line x1="10" y1="85" x2="24" y2="100" />
  <line x1="10" y1="97" x2="24" y2="112" />
  <line x1="10" y1="109" x2="24" y2="124" />
  <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="113" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="22" y1="0" x2="37" y2="14" />
  <line x1="34" y1="0" x2="49" y2="14" />
  <line x1="46" y1="0" x2="61" y2="14" />
  <line x1="58" y1="0" x2="73" y2="14" />
  <line x1="70" y1="0" x2="85" y2="14" />
  <line x1="82" y1="0" x2="97" y2="14" />
  <line x1="95" y1="0" x2="110" y2="14" />
  <line x1="107" y1="0" x2="122" y2="14" />
  <line x1="113" y1="0" x2="128" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 113.24201364850164,0.0 128.19061159825606,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />
  <line x1="24" y1="27" x2="128" y2="27" />
  <line x1="24" y1="39" x2="128" y2="39" />
  <line x1="24" y1="51" x2="128" y2="51" />
  <line x1="24" y1="63" x2="128" y2="63" />
  <line x1="24" y1="75" x2="128" y2="75" />
  <line x1="24" y1="87" x2="128" y2="87" />
  <line x1="24" y1="100" x2="128" y2="100" />
  <line x1="24" y1="112" x2="128" y2="112" />
  <line x1="24" y1="124" x2="128" y2="124" />
  <line x1="24" y1="134" x2="128" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />
  <line x1="37" y1="14" x2="37" y2="134" />
  <line x1="49" y1="14" x2="49" y2="134" />
  <line x1="61" y1="14" x2="61" y2="134" />
  <line x1="73" y1="14" x2="73" y2="134" />
  <line x1="85" y1="14" x2="85" y2="134" />
  <line x1="97" y1="14" x2="97" y2="134" />
  <line x1="110" y1="14" x2="110" y2="134" />
  <line x1="122" y1="14" x2="122" y2="134" />
  <line x1="128" y1="14" x2="128" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 128.19061159825606,14.948597949754403 128.19061159825606,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="76.569605" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" >8699</text>
  <text x="148.190612" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,148.190612,74.948598)">10111</text>
  <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>blue</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-34f58c65-5cbb-4812-b69c-ec80318da2e9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34f58c65-5cbb-4812-b69c-ec80318da2e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b352443a-af8c-49f9-abdb-552dbc2f97b7' class='xr-var-data-in' type='checkbox'><label for='data-b352443a-af8c-49f9-abdb-552dbc2f97b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 10111, 8699) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 90 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="178" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="12" x2="24" y2="27" />
  <line x1="10" y1="24" x2="24" y2="39" />
  <line x1="10" y1="36" x2="24" y2="51" />
  <line x1="10" y1="48" x2="24" y2="63" />
  <line x1="10" y1="60" x2="24" y2="75" />
  <line x1="10" y1="72" x2="24" y2="87" />
  <line x1="10" y1="85" x2="24" y2="100" />
  <line x1="10" y1="97" x2="24" y2="112" />
  <line x1="10" y1="109" x2="24" y2="124" />
  <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="113" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="22" y1="0" x2="37" y2="14" />
  <line x1="34" y1="0" x2="49" y2="14" />
  <line x1="46" y1="0" x2="61" y2="14" />
  <line x1="58" y1="0" x2="73" y2="14" />
  <line x1="70" y1="0" x2="85" y2="14" />
  <line x1="82" y1="0" x2="97" y2="14" />
  <line x1="95" y1="0" x2="110" y2="14" />
  <line x1="107" y1="0" x2="122" y2="14" />
  <line x1="113" y1="0" x2="128" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 113.24201364850164,0.0 128.19061159825606,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />
  <line x1="24" y1="27" x2="128" y2="27" />
  <line x1="24" y1="39" x2="128" y2="39" />
  <line x1="24" y1="51" x2="128" y2="51" />
  <line x1="24" y1="63" x2="128" y2="63" />
  <line x1="24" y1="75" x2="128" y2="75" />
  <line x1="24" y1="87" x2="128" y2="87" />
  <line x1="24" y1="100" x2="128" y2="100" />
  <line x1="24" y1="112" x2="128" y2="112" />
  <line x1="24" y1="124" x2="128" y2="124" />
  <line x1="24" y1="134" x2="128" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />
  <line x1="37" y1="14" x2="37" y2="134" />
  <line x1="49" y1="14" x2="49" y2="134" />
  <line x1="61" y1="14" x2="61" y2="134" />
  <line x1="73" y1="14" x2="73" y2="134" />
  <line x1="85" y1="14" x2="85" y2="134" />
  <line x1="97" y1="14" x2="97" y2="134" />
  <line x1="110" y1="14" x2="110" y2="134" />
  <line x1="122" y1="14" x2="122" y2="134" />
  <line x1="128" y1="14" x2="128" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 128.19061159825606,14.948597949754403 128.19061159825606,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="76.569605" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" >8699</text>
  <text x="148.190612" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,148.190612,74.948598)">10111</text>
  <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">3</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nir</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3, 1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-afba11f3-238c-4fea-b566-71fe6b2d4a14' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-afba11f3-238c-4fea-b566-71fe6b2d4a14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-298b069e-69f5-4a38-925a-4fd3f28e6bd8' class='xr-var-data-in' type='checkbox'><label for='data-298b069e-69f5-4a38-925a-4fd3f28e6bd8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 12.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3, 10111, 8699) </td>
                        <td> (3, 1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 90 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="178" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="12" x2="24" y2="27" />
  <line x1="10" y1="24" x2="24" y2="39" />
  <line x1="10" y1="36" x2="24" y2="51" />
  <line x1="10" y1="48" x2="24" y2="63" />
  <line x1="10" y1="60" x2="24" y2="75" />
  <line x1="10" y1="72" x2="24" y2="87" />
  <line x1="10" y1="85" x2="24" y2="100" />
  <line x1="10" y1="97" x2="24" y2="112" />
  <line x1="10" y1="109" x2="24" y2="124" />
  <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="113" y2="0" style="stroke-width:2" />
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="22" y1="0" x2="37" y2="14" />
  <line x1="34" y1="0" x2="49" y2="14" />
  <line x1="46" y1="0" x2="61" y2="14" />
  <line x1="58" y1="0" x2="73" y2="14" />
  <line x1="70" y1="0" x2="85" y2="14" />
  <line x1="82" y1="0" x2="97" y2="14" />
  <line x1="95" y1="0" x2="110" y2="14" />
  <line x1="107" y1="0" x2="122" y2="14" />
  <line x1="113" y1="0" x2="128" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 113.24201364850164,0.0 128.19061159825606,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="128" y2="14" style="stroke-width:2" />
  <line x1="24" y1="27" x2="128" y2="27" />
  <line x1="24" y1="39" x2="128" y2="39" />
  <line x1="24" y1="51" x2="128" y2="51" />
  <line x1="24" y1="63" x2="128" y2="63" />
  <line x1="24" y1="75" x2="128" y2="75" />
  <line x1="24" y1="87" x2="128" y2="87" />
  <line x1="24" y1="100" x2="128" y2="100" />
  <line x1="24" y1="112" x2="128" y2="112" />
  <line x1="24" y1="124" x2="128" y2="124" />
  <line x1="24" y1="134" x2="128" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2" />
  <line x1="37" y1="14" x2="37" y2="134" />
  <line x1="49" y1="14" x2="49" y2="134" />
  <line x1="61" y1="14" x2="61" y2="134" />
  <line x1="73" y1="14" x2="73" y2="134" />
  <line x1="85" y1="14" x2="85" y2="134" />
  <line x1="97" y1="14" x2="97" y2="134" />
  <line x1="110" y1="14" x2="110" y2="134" />
  <line x1="122" y1="14" x2="122" y2="134" />
  <line x1="128" y1="14" x2="128" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 128.19061159825606,14.948597949754403 128.19061159825606,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="76.569605" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" >8699</text>
  <text x="148.190612" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,148.190612,74.948598)">10111</text>
  <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">3</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-7694a0f9-d174-449e-8441-d8671b6ee153' class='xr-section-summary-in' type='checkbox'  ><label for='section-7694a0f9-d174-449e-8441-d8671b6ee153' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1129a020-eaef-49ee-b866-9423b8c99498' class='xr-index-data-in' type='checkbox'/><label for='index-1129a020-eaef-49ee-b866-9423b8c99498' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1498005.0, 1497995.0, 1497985.0, 1497975.0, 1497965.0, 1497955.0,
       1497945.0, 1497935.0, 1497925.0, 1497915.0,
       ...
       1396995.0, 1396985.0, 1396975.0, 1396965.0, 1396955.0, 1396945.0,
       1396935.0, 1396925.0, 1396915.0, 1396905.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=10111))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c98a0bd0-8def-4862-a0b2-e383ee9ae5be' class='xr-index-data-in' type='checkbox'/><label for='index-c98a0bd0-8def-4862-a0b2-e383ee9ae5be' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([719415.0, 719425.0, 719435.0, 719445.0, 719455.0, 719465.0, 719475.0,
       719485.0, 719495.0, 719505.0,
       ...
       806305.0, 806315.0, 806325.0, 806335.0, 806345.0, 806355.0, 806365.0,
       806375.0, 806385.0, 806395.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=8699))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-564f2fae-6737-4d2a-b6aa-de7fc6f88dd5' class='xr-index-data-in' type='checkbox'/><label for='index-564f2fae-6737-4d2a-b6aa-de7fc6f88dd5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-07-12 05:25:21.422000&#x27;, &#x27;2020-10-30 05:25:22.754000&#x27;,
               &#x27;2020-10-30 05:25:22.755000&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4c06141b-06d2-414a-a853-d8d04bbf783b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4c06141b-06d2-414a-a853-d8d04bbf783b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2825af1a0&gt;
</pre></div>
</div>
<img alt="../_images/189e6c822f2cf58c2335b3f86391d203504b42496bc7700ac02e52b13e19dd21.png" src="../_images/189e6c822f2cf58c2335b3f86391d203504b42496bc7700ac02e52b13e19dd21.png" />
</div>
</div>
<p>Let’s chunk again to optimize handling of the raster datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">masked_s2_ndvi_composite</span> <span class="o">=</span> <span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">})</span>
<span class="n">rasterized_field_boundaries</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Combine the NDVI and field boundareis rasters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rasterized_field_boundaries</span><span class="p">[</span><span class="s2">&quot;ndvi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span> <span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rasterized_field_boundaries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1GB
Dimensions:          (y: 10111, x: 8699)
Coordinates:
  * y                (y) float64 81kB 1.498e+06 1.498e+06 ... 1.397e+06
  * x                (x) float64 70kB 7.194e+05 7.194e+05 ... 8.064e+05
    spatial_ref      int64 8B 0
Data variables:
    numerical_class  (y, x) float64 704MB dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;
    ndvi             (y, x) float32 352MB 0.418 0.3964 0.3867 ... 0.6068 0.6541</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-31f25d8d-1385-42a4-86b6-3744f02be4c9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-31f25d8d-1385-42a4-86b6-3744f02be4c9' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 10111</li><li><span class='xr-has-index'>x</span>: 8699</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-18624f27-b593-4175-8427-82597b9876ef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-18624f27-b593-4175-8427-82597b9876ef' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.498e+06 1.498e+06 ... 1.397e+06</div><input id='attrs-0e6ef78e-feaf-4320-a934-97da4b2e8019' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e6ef78e-feaf-4320-a934-97da4b2e8019' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6c10d27-cf01-4c05-9b4d-38dded55450b' class='xr-var-data-in' type='checkbox'><label for='data-a6c10d27-cf01-4c05-9b4d-38dded55450b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([1498005., 1497995., 1497985., ..., 1396925., 1396915., 1396905.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.194e+05 7.194e+05 ... 8.064e+05</div><input id='attrs-36fdd1da-d9e0-46e4-8723-4b8b4e580a3b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36fdd1da-d9e0-46e4-8723-4b8b4e580a3b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dfe13d1c-a8bd-4e7b-81b1-f657d42f0131' class='xr-var-data-in' type='checkbox'><label for='data-dfe13d1c-a8bd-4e7b-81b1-f657d42f0131' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([719415., 719425., 719435., ..., 806375., 806385., 806395.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-b2c3aeca-6601-4538-ad81-235c5c3b2544' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2c3aeca-6601-4538-ad81-235c5c3b2544' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe3e7497-1eb3-461d-8df4-2bb11a371d68' class='xr-var-data-in' type='checkbox'><label for='data-fe3e7497-1eb3-461d-8df4-2bb11a371d68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 43N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 43N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32643&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>719410.0 10.0 0.0 1498010.0 0.0 -10.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7837653f-985f-42d2-8750-36230595684d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7837653f-985f-42d2-8750-36230595684d' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>numerical_class</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1024, 1024), meta=np.ndarray&gt;</div><input id='attrs-d1969b1c-100c-4e24-b215-c00a0d52b195' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1969b1c-100c-4e24-b215-c00a0d52b195' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3786cba3-59d0-46c0-8fb9-dc297d3bb212' class='xr-var-data-in' type='checkbox'><label for='data-3786cba3-59d0-46c0-8fb9-dc297d3bb212' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>numerical_class</dd><dt><span>long_name :</span></dt><dd>numerical_class</dd><dt><span>_FillValue :</span></dt><dd>nan</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 671.05 MiB </td>
                        <td> 8.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10111, 8699) </td>
                        <td> (1024, 1024) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 90 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="153" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="103" y2="0" style="stroke-width:2" />
  <line x1="0" y1="12" x2="103" y2="12" />
  <line x1="0" y1="24" x2="103" y2="24" />
  <line x1="0" y1="36" x2="103" y2="36" />
  <line x1="0" y1="48" x2="103" y2="48" />
  <line x1="0" y1="60" x2="103" y2="60" />
  <line x1="0" y1="72" x2="103" y2="72" />
  <line x1="0" y1="85" x2="103" y2="85" />
  <line x1="0" y1="97" x2="103" y2="97" />
  <line x1="0" y1="109" x2="103" y2="109" />
  <line x1="0" y1="120" x2="103" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="12" y1="0" x2="12" y2="120" />
  <line x1="24" y1="0" x2="24" y2="120" />
  <line x1="36" y1="0" x2="36" y2="120" />
  <line x1="48" y1="0" x2="48" y2="120" />
  <line x1="60" y1="0" x2="60" y2="120" />
  <line x1="72" y1="0" x2="72" y2="120" />
  <line x1="85" y1="0" x2="85" y2="120" />
  <line x1="97" y1="0" x2="97" y2="120" />
  <line x1="103" y1="0" x2="103" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 103.24201364850164,0.0 103.24201364850164,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="51.621007" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >8699</text>
  <text x="123.242014" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,123.242014,60.000000)">10111</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ndvi</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.418 0.3964 ... 0.6068 0.6541</div><input id='attrs-032e4939-da75-4b64-b284-b7bd2c97d80a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-032e4939-da75-4b64-b284-b7bd2c97d80a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbfb749c-2f4c-4b6c-b844-324ff49b0e44' class='xr-var-data-in' type='checkbox'><label for='data-fbfb749c-2f4c-4b6c-b844-324ff49b0e44' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.41801727, 0.39635825, 0.38674915, ...,        nan,        nan,
               nan],
       [0.5550838 , 0.49648008, 0.49164832, ...,        nan,        nan,
               nan],
       [0.52466625, 0.48525032, 0.49181208, ...,        nan,        nan,
               nan],
       ...,
       [0.5661569 , 0.5439752 , 0.56187266, ..., 0.53072625, 0.59725356,
        0.61374485],
       [0.5555094 , 0.5511494 , 0.5975017 , ..., 0.57171506, 0.57547045,
        0.6112346 ],
       [0.6454925 , 0.6667719 , 0.6838638 , ..., 0.56866914, 0.60683006,
        0.65412015]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-82fd1daa-973f-48b8-978b-b3eab1abe9c4' class='xr-section-summary-in' type='checkbox'  ><label for='section-82fd1daa-973f-48b8-978b-b3eab1abe9c4' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ea2b7272-4b1d-4fce-9362-4640dd097094' class='xr-index-data-in' type='checkbox'/><label for='index-ea2b7272-4b1d-4fce-9362-4640dd097094' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1498005.0, 1497995.0, 1497985.0, 1497975.0, 1497965.0, 1497955.0,
       1497945.0, 1497935.0, 1497925.0, 1497915.0,
       ...
       1396995.0, 1396985.0, 1396975.0, 1396965.0, 1396955.0, 1396945.0,
       1396935.0, 1396925.0, 1396915.0, 1396905.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=10111))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-04b7adb7-5177-4662-8e3a-9dae9dfdbac1' class='xr-index-data-in' type='checkbox'/><label for='index-04b7adb7-5177-4662-8e3a-9dae9dfdbac1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([719415.0, 719425.0, 719435.0, 719445.0, 719455.0, 719465.0, 719475.0,
       719485.0, 719495.0, 719505.0,
       ...
       806305.0, 806315.0, 806325.0, 806335.0, 806345.0, 806355.0, 806365.0,
       806375.0, 806385.0, 806395.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=8699))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-473f1a7d-fc04-4086-932a-3d7be876b4f5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-473f1a7d-fc04-4086-932a-3d7be876b4f5' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Now let’s get the aggregate zonal statistics for the field boundaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rasterized_field_boundaries_</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;spatial_ref&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">rasterized_field_boundaries</span><span class="o">.</span><span class="n">numerical_class</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_boundaries_india_clipped_ndvi_mean</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries_</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ndvi&quot;</span><span class="p">:</span> <span class="s2">&quot;ndvi_mean&quot;</span><span class="p">})</span>
<span class="n">field_boundaries_india_clipped_ndvi_min</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries_</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ndvi&quot;</span><span class="p">:</span> <span class="s2">&quot;ndvi_min&quot;</span><span class="p">})</span>
<span class="n">field_boundaries_india_clipped_ndvi_max</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries_</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ndvi&quot;</span><span class="p">:</span> <span class="s2">&quot;ndvi_max&quot;</span><span class="p">})</span>
<span class="n">field_boundaries_india_clipped_ndvi_std</span> <span class="o">=</span> <span class="n">rasterized_field_boundaries_</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ndvi&quot;</span><span class="p">:</span> <span class="s2">&quot;ndvi_std&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_boundaries_india_clipped_ndvi_mean</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;bound method Mapping.values of &lt;xarray.Dataset&gt; Size: 24B
Dimensions:          (numerical_class: 2)
Coordinates:
  * numerical_class  (numerical_class) float64 16B 0.0 1.0
Data variables:
    ndvi_mean        (numerical_class) float32 8B 0.5307 0.4909&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zonal_stats_ndvi</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">field_boundaries_india_clipped_ndvi_mean</span><span class="p">,</span> <span class="n">field_boundaries_india_clipped_ndvi_min</span><span class="p">,</span> <span class="n">field_boundaries_india_clipped_ndvi_max</span><span class="p">,</span> <span class="n">field_boundaries_india_clipped_ndvi_std</span><span class="p">])</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">zonal_stats_ndvi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ndvi_mean</th>
      <th>ndvi_min</th>
      <th>ndvi_max</th>
      <th>ndvi_std</th>
    </tr>
    <tr>
      <th>numerical_class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.530743</td>
      <td>-1.000000</td>
      <td>1.000000</td>
      <td>0.200228</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>0.490864</td>
      <td>0.085095</td>
      <td>0.804157</td>
      <td>0.167253</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s calculate non-aggregated (per field boundary polygon) basic statistics for NDVI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate zonal stats</span>
<span class="n">zonal_stats_ndvi</span> <span class="o">=</span> <span class="n">zonal_stats</span><span class="p">(</span>
    <span class="n">clipped_field_boundaries_india</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">32643</span><span class="p">),</span>
    <span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">affine</span><span class="o">=</span><span class="n">masked_s2_ndvi_composite</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">transform</span><span class="p">(),</span>
    <span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">],</span>
    <span class="n">geojson_out</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Convert the results back to a GeoDataFrame</span>
<span class="n">zonal_stats_ndvi_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">zonal_stats_ndvi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zonal_stats_ndvi_gdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>area</th>
      <th>sample</th>
      <th>numerical_class</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POLYGON ((738131.85 1439263.932, 738133.306 14...</td>
      <td>452.008538</td>
      <td>27</td>
      <td>1</td>
      <td>0.692072</td>
      <td>0.702829</td>
      <td>0.697427</td>
      <td>2.789707</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POLYGON ((738113.871 1439273.154, 738115.318 1...</td>
      <td>468.519884</td>
      <td>27</td>
      <td>1</td>
      <td>0.679882</td>
      <td>0.700590</td>
      <td>0.689284</td>
      <td>2.757134</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POLYGON ((738125.574 1439318.164, 738131.871 1...</td>
      <td>381.477574</td>
      <td>27</td>
      <td>1</td>
      <td>0.615271</td>
      <td>0.638046</td>
      <td>0.626659</td>
      <td>1.253317</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POLYGON ((738106.283 1439310.597, 738107.74 14...</td>
      <td>449.036190</td>
      <td>27</td>
      <td>1</td>
      <td>0.567802</td>
      <td>0.620025</td>
      <td>0.587040</td>
      <td>1.761121</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POLYGON ((738103.12 1439340.673, 738104.577 14...</td>
      <td>559.956668</td>
      <td>27</td>
      <td>1</td>
      <td>0.543801</td>
      <td>0.650316</td>
      <td>0.579324</td>
      <td>2.896618</td>
    </tr>
    <tr>
      <th>5</th>
      <td>POLYGON ((801742.521 1402559.627, 801743.973 1...</td>
      <td>3220.019947</td>
      <td>104</td>
      <td>1</td>
      <td>0.237503</td>
      <td>0.507128</td>
      <td>0.341500</td>
      <td>10.927989</td>
    </tr>
    <tr>
      <th>6</th>
      <td>POLYGON ((801591.023 1402583.684, 801592.474 1...</td>
      <td>2333.354229</td>
      <td>104</td>
      <td>1</td>
      <td>0.168565</td>
      <td>0.546557</td>
      <td>0.381363</td>
      <td>9.534066</td>
    </tr>
    <tr>
      <th>7</th>
      <td>POLYGON ((801616.689 1402859.442, 801618.141 1...</td>
      <td>2175.137974</td>
      <td>104</td>
      <td>1</td>
      <td>0.264473</td>
      <td>0.348570</td>
      <td>0.305190</td>
      <td>6.408987</td>
    </tr>
    <tr>
      <th>8</th>
      <td>POLYGON ((801775.796 1402940.613, 801787.428 1...</td>
      <td>6876.249467</td>
      <td>104</td>
      <td>1</td>
      <td>0.085095</td>
      <td>0.475538</td>
      <td>0.310364</td>
      <td>21.104778</td>
    </tr>
    <tr>
      <th>9</th>
      <td>POLYGON ((802210.612 1403030.66, 802212.073 14...</td>
      <td>1781.159808</td>
      <td>104</td>
      <td>1</td>
      <td>0.408417</td>
      <td>0.525182</td>
      <td>0.487527</td>
      <td>8.287964</td>
    </tr>
    <tr>
      <th>10</th>
      <td>POLYGON ((806200.341 1404669.145, 806201.792 1...</td>
      <td>1333.233897</td>
      <td>90</td>
      <td>1</td>
      <td>0.547016</td>
      <td>0.683138</td>
      <td>0.626002</td>
      <td>8.764026</td>
    </tr>
    <tr>
      <th>11</th>
      <td>POLYGON ((806232.949 1404657.152, 806234.4 140...</td>
      <td>4836.028260</td>
      <td>90</td>
      <td>1</td>
      <td>0.431082</td>
      <td>0.624055</td>
      <td>0.561027</td>
      <td>26.368275</td>
    </tr>
    <tr>
      <th>12</th>
      <td>POLYGON ((806179.139 1404747.409, 806180.59 14...</td>
      <td>1799.699851</td>
      <td>90</td>
      <td>1</td>
      <td>0.357772</td>
      <td>0.654723</td>
      <td>0.479605</td>
      <td>9.112486</td>
    </tr>
    <tr>
      <th>13</th>
      <td>POLYGON ((806204.809 1404793.608, 806206.27 14...</td>
      <td>764.365011</td>
      <td>90</td>
      <td>1</td>
      <td>0.361153</td>
      <td>0.615836</td>
      <td>0.478926</td>
      <td>3.831412</td>
    </tr>
    <tr>
      <th>14</th>
      <td>POLYGON ((806253.869 1404784.752, 806255.803 1...</td>
      <td>1982.638401</td>
      <td>90</td>
      <td>1</td>
      <td>0.436280</td>
      <td>0.630789</td>
      <td>0.515023</td>
      <td>9.270410</td>
    </tr>
    <tr>
      <th>15</th>
      <td>POLYGON ((798346.648 1406216.364, 798348.1 140...</td>
      <td>3447.764752</td>
      <td>950</td>
      <td>1</td>
      <td>0.389673</td>
      <td>0.668348</td>
      <td>0.450350</td>
      <td>15.762251</td>
    </tr>
    <tr>
      <th>16</th>
      <td>POLYGON ((797915.932 1406385.597, 797917.384 1...</td>
      <td>750.264877</td>
      <td>950</td>
      <td>1</td>
      <td>0.402845</td>
      <td>0.503132</td>
      <td>0.451355</td>
      <td>3.610841</td>
    </tr>
    <tr>
      <th>17</th>
      <td>POLYGON ((797959.583 1406382.601, 797961.035 1...</td>
      <td>1771.659656</td>
      <td>950</td>
      <td>1</td>
      <td>0.452709</td>
      <td>0.562196</td>
      <td>0.502439</td>
      <td>9.043905</td>
    </tr>
    <tr>
      <th>18</th>
      <td>POLYGON ((797939.972 1406403.619, 797941.424 1...</td>
      <td>2019.944969</td>
      <td>950</td>
      <td>1</td>
      <td>0.382955</td>
      <td>0.591496</td>
      <td>0.501239</td>
      <td>10.526028</td>
    </tr>
    <tr>
      <th>19</th>
      <td>POLYGON ((797932.323 1406439.583, 797933.775 1...</td>
      <td>1067.775269</td>
      <td>950</td>
      <td>1</td>
      <td>0.469278</td>
      <td>0.644798</td>
      <td>0.548556</td>
      <td>6.034115</td>
    </tr>
    <tr>
      <th>20</th>
      <td>POLYGON ((768371.235 1397348.625, 768405.651 1...</td>
      <td>1025.247142</td>
      <td>1388</td>
      <td>1</td>
      <td>0.520904</td>
      <td>0.620862</td>
      <td>0.577506</td>
      <td>6.930070</td>
    </tr>
    <tr>
      <th>21</th>
      <td>POLYGON ((768407.266 1397383.023, 768428.11 13...</td>
      <td>721.308522</td>
      <td>1388</td>
      <td>1</td>
      <td>0.481896</td>
      <td>0.531073</td>
      <td>0.509232</td>
      <td>3.055393</td>
    </tr>
    <tr>
      <th>22</th>
      <td>POLYGON ((768452.332 1397384.436, 768474.623 1...</td>
      <td>714.963976</td>
      <td>1388</td>
      <td>1</td>
      <td>0.443722</td>
      <td>0.610212</td>
      <td>0.491227</td>
      <td>2.947363</td>
    </tr>
    <tr>
      <th>23</th>
      <td>POLYGON ((768377.216 1397383.23, 768405.81 139...</td>
      <td>948.333312</td>
      <td>1388</td>
      <td>1</td>
      <td>0.534976</td>
      <td>0.569513</td>
      <td>0.556226</td>
      <td>5.006033</td>
    </tr>
    <tr>
      <th>24</th>
      <td>POLYGON ((768429.552 1397384.71, 768450.877 13...</td>
      <td>725.152333</td>
      <td>1388</td>
      <td>1</td>
      <td>0.456531</td>
      <td>0.494898</td>
      <td>0.470357</td>
      <td>2.822145</td>
    </tr>
    <tr>
      <th>25</th>
      <td>POLYGON ((764659.755 1497406.653, 764661.205 1...</td>
      <td>4514.587506</td>
      <td>302</td>
      <td>1</td>
      <td>0.353751</td>
      <td>0.638009</td>
      <td>0.482322</td>
      <td>21.704498</td>
    </tr>
    <tr>
      <th>26</th>
      <td>POLYGON ((764613.318 1497414.58, 764614.774 14...</td>
      <td>6055.582627</td>
      <td>302</td>
      <td>1</td>
      <td>0.128436</td>
      <td>0.525225</td>
      <td>0.213946</td>
      <td>13.050730</td>
    </tr>
    <tr>
      <th>27</th>
      <td>POLYGON ((764734.893 1497523.894, 764736.344 1...</td>
      <td>1347.293092</td>
      <td>302</td>
      <td>1</td>
      <td>0.636561</td>
      <td>0.748684</td>
      <td>0.707922</td>
      <td>9.202991</td>
    </tr>
    <tr>
      <th>28</th>
      <td>POLYGON ((764697.161 1497529.933, 764698.612 1...</td>
      <td>1132.023878</td>
      <td>302</td>
      <td>1</td>
      <td>0.631731</td>
      <td>0.752459</td>
      <td>0.691951</td>
      <td>7.611464</td>
    </tr>
    <tr>
      <th>29</th>
      <td>POLYGON ((764620.928 1497571.623, 764632.514 1...</td>
      <td>3427.200102</td>
      <td>302</td>
      <td>1</td>
      <td>0.158979</td>
      <td>0.307197</td>
      <td>0.215362</td>
      <td>7.537686</td>
    </tr>
    <tr>
      <th>30</th>
      <td>POLYGON ((729241.019 1420568.793, 729242.468 1...</td>
      <td>503.241460</td>
      <td>1071</td>
      <td>1</td>
      <td>0.553196</td>
      <td>0.592618</td>
      <td>0.576617</td>
      <td>2.306467</td>
    </tr>
    <tr>
      <th>31</th>
      <td>POLYGON ((729245.706 1420586.596, 729247.165 1...</td>
      <td>471.225105</td>
      <td>1071</td>
      <td>1</td>
      <td>0.573806</td>
      <td>0.615776</td>
      <td>0.592837</td>
      <td>2.964184</td>
    </tr>
    <tr>
      <th>32</th>
      <td>POLYGON ((729268.398 1420595.67, 729269.847 14...</td>
      <td>185.511319</td>
      <td>1071</td>
      <td>1</td>
      <td>0.679440</td>
      <td>0.721636</td>
      <td>0.700538</td>
      <td>1.401076</td>
    </tr>
    <tr>
      <th>33</th>
      <td>POLYGON ((729250.427 1420601.441, 729251.886 1...</td>
      <td>238.424294</td>
      <td>1071</td>
      <td>1</td>
      <td>0.619348</td>
      <td>0.640485</td>
      <td>0.633177</td>
      <td>1.899530</td>
    </tr>
    <tr>
      <th>34</th>
      <td>POLYGON ((729257.554 1420618.273, 729259.012 1...</td>
      <td>520.434613</td>
      <td>1071</td>
      <td>1</td>
      <td>0.681896</td>
      <td>0.776363</td>
      <td>0.730320</td>
      <td>4.381920</td>
    </tr>
    <tr>
      <th>35</th>
      <td>POLYGON ((720211.65 1401183.399, 720213.111 14...</td>
      <td>3448.199831</td>
      <td>1628</td>
      <td>1</td>
      <td>0.540646</td>
      <td>0.767664</td>
      <td>0.643714</td>
      <td>23.817423</td>
    </tr>
    <tr>
      <th>36</th>
      <td>POLYGON ((720187.523 1401233.049, 720188.984 1...</td>
      <td>7783.891636</td>
      <td>1628</td>
      <td>1</td>
      <td>0.504723</td>
      <td>0.759388</td>
      <td>0.607912</td>
      <td>46.809223</td>
    </tr>
    <tr>
      <th>37</th>
      <td>POLYGON ((720205.462 1401294.376, 720206.913 1...</td>
      <td>6218.653945</td>
      <td>1628</td>
      <td>1</td>
      <td>0.630018</td>
      <td>0.797421</td>
      <td>0.695079</td>
      <td>43.789997</td>
    </tr>
    <tr>
      <th>38</th>
      <td>POLYGON ((720397.629 1401317.084, 720399.079 1...</td>
      <td>1628.083581</td>
      <td>1628</td>
      <td>1</td>
      <td>0.574337</td>
      <td>0.804157</td>
      <td>0.756457</td>
      <td>11.346850</td>
    </tr>
    <tr>
      <th>39</th>
      <td>POLYGON ((720410.962 1401346.794, 720412.413 1...</td>
      <td>2808.739045</td>
      <td>1628</td>
      <td>1</td>
      <td>0.433908</td>
      <td>0.738684</td>
      <td>0.568553</td>
      <td>15.350925</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="02_dynamic_visualization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Analyzing Agricultural Fields and Temperature Patterns in India using Lonboard</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-objectives">Main Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-raster-data">Accessing raster data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-raster-data">Working with Raster Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-raster-data">Visualizing raster data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deciphering-the-raster-coordinate-reference-system-crs">Deciphering the Raster Coordinate Reference System (CRS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-raster-statistics">Calculate Raster Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-data">Dealing with Missing Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#incorporating-multiple-bands">Incorporating multiple bands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-cloud-covered-and-invalid-pixels">Dealing with cloud-covered and invalid pixels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-a-spectral-index">Calculate a spectral index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zonal-statistics">Zonal statistics</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Development Seed
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>